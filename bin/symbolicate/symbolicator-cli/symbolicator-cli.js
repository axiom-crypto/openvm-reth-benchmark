(()=>{"use strict";var e,t,r,n,a={6:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(e){e&&"limit"in e&&(this._limit=e.limit),this.clear()}n.prototype={toString:function(){return"[object TupleMap]"},_hash:function(e){if(e===this._lastTuple)return this._lastHash;for(var t=e.length,n=[],a=0;a<t;a++){var s=e[a],o=void 0===s?"undefined":r(s);if(null===s||"object"!==o&&"function"!==o)n.push("string"===o?'"'+s+'"':""+s);else if(this._idMap.has(s))n.push(this._idMap.get(s));else{var i="#"+this._id++;this._idMap.set(s,i),n.push(i)}}return this._lastTuple=e,this._lastHash=n.join("/<[MI_SEP]>/"),this._lastHash},has:function(e){var t=this._hash(e);return this._cache.has(t)},set:function(e,t){var r=this._hash(e);return void 0!==this._limit&&this._cache.delete(r),this._cache.set(r,t),void 0!==this._limit&&this._cache.size>this._limit&&this._cache.delete(this._cache.keys().next().value),this},get:function(e){var t=this._hash(e);if(void 0!==this._limit&&this._cache.has(t)){var r=this._cache.get(t);return this._cache.delete(t),this._cache.set(t,r),r}return this._cache.get(t)},clear:function(){this._cache=new Map,this._idMap=new WeakMap,this._id=0,delete this._lastTuple,delete this._lastHash}},t.default=n,e.exports=t.default},31:e=>{function t(e){return"number"==typeof e||!!/^0x[0-9a-f]+$/i.test(e)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e)}function r(e,t){return"constructor"===t&&"function"==typeof e[t]||"__proto__"===t}e.exports=function(e,n){n||(n={});var a={bools:{},strings:{},unknownFn:null};"function"==typeof n.unknown&&(a.unknownFn=n.unknown),"boolean"==typeof n.boolean&&n.boolean?a.allBools=!0:[].concat(n.boolean).filter(Boolean).forEach((function(e){a.bools[e]=!0}));var s={};function o(e){return s[e].some((function(e){return a.bools[e]}))}Object.keys(n.alias||{}).forEach((function(e){s[e]=[].concat(n.alias[e]),s[e].forEach((function(t){s[t]=[e].concat(s[e].filter((function(e){return t!==e})))}))})),[].concat(n.string).filter(Boolean).forEach((function(e){a.strings[e]=!0,s[e]&&[].concat(s[e]).forEach((function(e){a.strings[e]=!0}))}));var i=n.default||{},l={_:[]};function c(e,t,n){for(var s=e,o=0;o<t.length-1;o++){var i=t[o];if(r(s,i))return;void 0===s[i]&&(s[i]={}),s[i]!==Object.prototype&&s[i]!==Number.prototype&&s[i]!==String.prototype||(s[i]={}),s[i]===Array.prototype&&(s[i]=[]),s=s[i]}var l=t[t.length-1];r(s,l)||(s!==Object.prototype&&s!==Number.prototype&&s!==String.prototype||(s={}),s===Array.prototype&&(s=[]),void 0===s[l]||a.bools[l]||"boolean"==typeof s[l]?s[l]=n:Array.isArray(s[l])?s[l].push(n):s[l]=[s[l],n])}function u(e,r,n){if(!n||!a.unknownFn||function(e,t){return a.allBools&&/^--[^=]+$/.test(t)||a.strings[e]||a.bools[e]||s[e]}(e,n)||!1!==a.unknownFn(n)){var o=!a.strings[e]&&t(r)?Number(r):r;c(l,e.split("."),o),(s[e]||[]).forEach((function(e){c(l,e.split("."),o)}))}}Object.keys(a.bools).forEach((function(e){u(e,void 0!==i[e]&&i[e])}));var m=[];-1!==e.indexOf("--")&&(m=e.slice(e.indexOf("--")+1),e=e.slice(0,e.indexOf("--")));for(var d=0;d<e.length;d++){var h,f,p=e[d];if(/^--.+=/.test(p)){var g=p.match(/^--([^=]+)=([\s\S]*)$/);h=g[1];var y=g[2];a.bools[h]&&(y="false"!==y),u(h,y,p)}else if(/^--no-.+/.test(p))u(h=p.match(/^--no-(.+)/)[1],!1,p);else if(/^--.+/.test(p))h=p.match(/^--(.+)/)[1],void 0===(f=e[d+1])||/^(-|--)[^-]/.test(f)||a.bools[h]||a.allBools||s[h]&&o(h)?/^(true|false)$/.test(f)?(u(h,"true"===f,p),d+=1):u(h,!a.strings[h]||"",p):(u(h,f,p),d+=1);else if(/^-[^-]+/.test(p)){for(var b=p.slice(1,-1).split(""),w=!1,k=0;k<b.length;k++)if("-"!==(f=p.slice(k+2))){if(/[A-Za-z]/.test(b[k])&&"="===f[0]){u(b[k],f.slice(1),p),w=!0;break}if(/[A-Za-z]/.test(b[k])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(f)){u(b[k],f,p),w=!0;break}if(b[k+1]&&b[k+1].match(/\W/)){u(b[k],p.slice(k+2),p),w=!0;break}u(b[k],!a.strings[b[k]]||"",p)}else u(b[k],f,p);h=p.slice(-1)[0],w||"-"===h||(!e[d+1]||/^(-|--)[^-]/.test(e[d+1])||a.bools[h]||s[h]&&o(h)?e[d+1]&&/^(true|false)$/.test(e[d+1])?(u(h,"true"===e[d+1],p),d+=1):u(h,!a.strings[h]||"",p):(u(h,e[d+1],p),d+=1))}else if(a.unknownFn&&!1===a.unknownFn(p)||l._.push(a.strings._||!t(p)?p:Number(p)),n.stopEarly){l._.push.apply(l._,e.slice(d+1));break}}return Object.keys(i).forEach((function(e){var t,r,n;t=l,r=e.split("."),n=t,r.slice(0,-1).forEach((function(e){n=n[e]||{}})),r[r.length-1]in n||(c(l,e.split("."),i[e]),(s[e]||[]).forEach((function(t){c(l,t.split("."),i[e])})))})),n["--"]?l["--"]=m.slice():m.forEach((function(e){l._.push(e)})),l}},119:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=r(6))&&n.__esModule?n:{default:n};if("undefined"==typeof WeakMap||"undefined"==typeof Map)throw new Error("This lib requires an implementation of WeakMap and Map");t.default=function(e,t){var r=t&&t.cache||new a.default(t),n=void 0;return n=/^\[object (Weak|LRU|NamedTuple)?Map\]$/.test(r.toString())?function(t){if(!r.has(t)){var n=e.call(this,t);return r.set(t,n),n}return r.get(t)}:function(){if(!r.has(arguments)){var t=e.apply(this,arguments);return r.set(arguments,t),t}return r.get(arguments)},e.name&&(n.displayName=e.name+"Memoized"),n},e.exports=t.default},263:(e,t,r)=>{r.d(t,{M:()=>a});const n=new WeakMap;class a{constructor(e){this._array=void 0,this._stringToIndex=void 0,this._array=e,this._stringToIndex=new Map;for(let t=0;t<e.length;t++)this._stringToIndex.set(e[t],t)}static withBackingArray(e){let t=n.get(e);return void 0===t&&(t=new a(e),n.set(e,t)),t}getString(e,t){if(!this.hasIndex(e)){if(t)return console.warn(`index ${e} not in StringTable`),t;throw new Error(`index ${e} not in StringTable`)}return this._array[e]}hasIndex(e){return e in this._array}hasString(e){return this._stringToIndex.has(e)}indexForString(e){let t=this._stringToIndex.get(e);return void 0===t&&(t=this._array.length,this._stringToIndex.set(e,t),this._array.push(e)),t}getBackingArray(){return this._array}}},294:(e,t,r)=>{var n,a,s=r(737),o=r(263),i=r(919),l=r(839),c=r(119),u=r.n(c),m=r(617),d=r.n(m),h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=(n=["",""],a=["",""],Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(a)}}))),p=function(){function e(){for(var t=this,r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return"function"==typeof e?t.interimTag.bind(t,e):"string"==typeof e?t.transformEndResult(e):(e=e.map(t.transformString.bind(t)),t.transformEndResult(e.reduce(t.processSubstitutions.bind(t,n))))},n.length>0&&Array.isArray(n[0])&&(n=n[0]),this.transformers=n.map((function(e){return"function"==typeof e?e():e})),this.tag}return h(e,[{key:"interimTag",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return this.tag(f,e.apply(void 0,[t].concat(n)))}},{key:"processSubstitutions",value:function(e,t,r){var n=this.transformSubstitution(e.shift(),t);return"".concat(t,n,r)}},{key:"transformString",value:function(e){return this.transformers.reduce((function(e,t){return t.onString?t.onString(e):e}),e)}},{key:"transformSubstitution",value:function(e,t){return this.transformers.reduce((function(e,r){return r.onSubstitution?r.onSubstitution(e,t):e}),e)}},{key:"transformEndResult",value:function(e){return this.transformers.reduce((function(e,t){return t.onEndResult?t.onEndResult(e):e}),e)}}]),e}();const g=p;var y={separator:"",conjunction:"",serial:!1};const b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return{onSubstitution:function(t,r){if(Array.isArray(t)){var n=t.length,a=e.separator,s=e.conjunction,o=e.serial,i=r.match(/(\n?[^\S\n]+)$/);if(t=i?t.join(a+i[1]):t.join(a+" "),s&&n>1){var l=t.lastIndexOf(a);t=t.slice(0,l)+(o?a:"")+" "+s+t.slice(l+1)}}return t}}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"initial";return{onEndResult:function(t){if("initial"===e){var r=t.match(/^[^\S\n]*(?=\S)/gm),n=r&&Math.min.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r.map((function(e){return e.length}))));if(n){var a=new RegExp("^.{"+n+"}","gm");return t.replace(a,"")}return t}if("all"===e)return t.replace(/^[^\S\n]+/gm,"");throw new Error("Unknown type: "+e)}}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{onEndResult:function(t){if(""===e)return t.trim();if("start"===(e=e.toLowerCase())||"left"===e)return t.replace(/^\s*/,"");if("end"===e||"right"===e)return t.replace(/\s*$/,"");throw new Error("Side not supported: "+e)}}};new g(b({separator:","}),w,k),new g(b({separator:",",conjunction:"and"}),w,k),new g(b({separator:",",conjunction:"or"}),w,k);const v=function(e){return{onSubstitution:function(t,r){if(null==e||"string"!=typeof e)throw new Error("You need to specify a string character to split by.");return"string"==typeof t&&t.includes(e)&&(t=t.split(e)),t}}};var T=function(e){return null!=e&&!Number.isNaN(e)&&"boolean"!=typeof e};new g(v("\n"),(function(){return{onSubstitution:function(e){return Array.isArray(e)?e.filter(T):T(e)?e:""}}}),b,w,k);const S=function(e,t){return{onSubstitution:function(r,n){if(null==e||null==t)throw new Error("replaceSubstitutionTransformer requires at least 2 arguments.");return null==r?r:r.toString().replace(e,t)}}};new g(v("\n"),b,w,k,S(/&/g,"&amp;"),S(/</g,"&lt;"),S(/>/g,"&gt;"),S(/"/g,"&quot;"),S(/'/g,"&#x27;"),S(/`/g,"&#x60;"));const x=function(e,t){return{onEndResult:function(r){if(null==e||null==t)throw new Error("replaceResultTransformer requires at least 2 arguments.");return r.replace(e,t)}}};new g(x(/(?:\n(?:\s*))+/g," "),k),new g(x(/(?:\n\s*)/g,""),k),new g(b({separator:","}),x(/(?:\s+)/g," "),k),new g(b({separator:",",conjunction:"or"}),x(/(?:\s+)/g," "),k),new g(b({separator:",",conjunction:"and"}),x(/(?:\s+)/g," "),k),new g(b,w,k),new g(b,x(/(?:\s+)/g," "),k),new g(w,k),new g(w("all"),k),Symbol.iterator;const _={};r.p,r.p;const I=u()((function({samples:e,markers:t,jsAllocations:r,nativeAllocations:n},a){const s={start:1/0,end:-1/0};if(e.length){const{time:t,timeDeltas:r}=e;if(void 0!==t){const r=e.length-1;s.start=t[0],s.end=t[r]+a}else{const t=(0,i.Nn)(r);s.start=t[0];let n=0;for(let r=0;r<e.length;r++)n+=t[r];s.end=n+a}}else if(t.length)for(let e=0;e<t.length;e++){const r=t.startTime[e],n=t.endTime[e];switch(t.phase[e]){case l.mN:case l.nO:{const e=(0,i.Nn)(r);s.start=Math.min(s.start,e),s.end=Math.max(s.end,e+a);break}case l.a1:{const e=(0,i.Nn)(n);s.start=Math.min(s.start,e),s.end=Math.max(s.end,e+a);break}case l.KU:{const e=(0,i.Nn)(r),t=(0,i.Nn)(n);s.start=Math.min(s.start,e,t),s.end=Math.max(s.end,e+a,t+a);break}default:throw new Error("Unhandled marker phase type.")}}if(r){const e=r.length-1;s.start=Math.min(s.start,r.time[0]),s.end=Math.max(s.end,r.time[e]+a)}if(n){const e=n.length-1;s.start=Math.min(s.start,n.time[0]),s.end=Math.max(s.end,n.time[e]+a)}return s}),{cache:new(d())});function M(e,t,r,n){const{jsAllocations:a,nativeAllocations:s,samples:o,markers:i}=e,l={...o,stack:o.stack.map(r)},c={...i,data:i.data.map((function(e){return e&&"cause"in e&&e.cause?{...e,cause:{...e.cause,stack:n(e.cause.stack)}}:e}))},u={...e,samples:l,markers:c,stackTable:t};return a&&(u.jsAllocations={...a,stack:a.stack.map(n)}),s&&(u.nativeAllocations={...s,stack:s.stack.map(n)}),u}function C(e){return t=>{if(null===t)return null;const r=e.get(t);if(void 0===r)throw new Error("Could not find a stack when converting from an old stack to new stack.");return r}}function N(e,t){let r,n;if("GeckoMain"===t.name)if(t["eTLD+1"])r=t["eTLD+1"],n=e.filter((e=>"GeckoMain"===e.name&&e["eTLD+1"]===r));else if(t.processName)r=t.processName,n=e.filter((e=>"GeckoMain"===e.name&&e.processName===r));else switch(t.processType){case"default":r="Parent Process";break;case"gpu":r="GPU Process";break;case"rdd":r="Remote Data Decoder";break;case"tab":r="Content Process",n=e.filter((e=>"GeckoMain"===e.name&&"tab"===e.processType));break;case"plugin":r="Plugin Process";break;case"socket":r="Socket Process"}if(r||(r=t.name),n&&n.length>1){const e=1+n.indexOf(t);r+=` (${e}/${n.length})`}return r}function E(e,t,r,n){let a,o;try{const t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol&&"moz-extension:"!==t.protocol)throw new Error("not a webhost or extension protocol");a=t.origin,o=t.host}catch(t){a=e,o=null}let i=n.get(a);return void 0!==i||(i=t.length++,n.set(a,i),o?(t.lib[i]=null,t.name[i]=r.indexForString(a),t.host[i]=r.indexForString(o),t.type[i]=s.AU.webhost):(t.lib[i]=null,t.name[i]=r.indexForString(e),t.host[i]=null,t.type[i]=s.AU.url)),i}function A(e,t,r){const n=e.get(t);return n?n.find(r):void 0}function D(e,t,r){const n=e.get(t);return n?n.filter(r):[]}function O(e,t,r,n,a){const o=`${a.pid}:${a.tid}`,i=e.get(o);if(i)return i;const l=(0,s.Qh)();l.pid=`${a.pid}`,l.tid=o,l.processType="unknown",l.name="Chrome Thread";const c=A(r,"thread_name",(e=>e.pid===a.pid&&e.tid===a.tid));c&&(l.name=c.args.name,l.isMainThread=l.name.startsWith("Cr")&&l.name.endsWith("Main"));const u=A(r,"process_name",(e=>e.pid===a.pid));u&&(l.processName=u.args.name);const m=A(r,"process_labels",(e=>e.pid===a.pid));if(m){const e=m.args.labels;l.processName?l.processName=`${l.processName} (${e})`:l.processName=`Process ${a.pid} (${e})`}const d=A(r,"process_sort_index",(e=>e.pid===a.pid));let h=0;d&&(h=d.args.sort_index);const f=A(r,"thread_sort_index",(e=>e.pid===a.pid&&e.tid===a.tid));let p=0;f?p=f.args.sort_index:!c||"CrBrowserMain"!==c.args.name&&"CrGpuMain"!==c.args.name||(p=-1),n.threads.push(l);const g=new Map;g.set(void 0,null);const y={thread:l,nodeIdToStackId:g,funcKeyToFuncId:new Map,originToResourceIndex:new Map,lastSeenTime:a.ts/1e3,lastSampledTime:0,pid:a.pid,processSortIndex:h,threadSortIndex:p,tieBreakerIndex:t.size};return e.set(o,y),t.set(l,y),y}function P(e){switch(e.name){case"ProfileChunk":return e.args.data.timeDeltas;case"CpuProfile":return e.args.data.cpuProfile.timeDeltas;default:return}}function F(e){return new Promise((t=>{const r=new Image;r.src=e,r.addEventListener("load",(()=>{t({width:r.width,height:r.height})})),r.addEventListener("error",(()=>{t(null)}))}))}function U(e){const t=new Set([null]);for(let r=0;r<e.length;r++){if(!t.has(e.prefix[r]))throw new Error("The stack ordering is incorrect");t.add(r)}}class ${constructor(e){this._libs=void 0,this._libRanges=void 0,this._libs=e,this._libRanges=e.map((e=>{const t=BigInt(e.start);return{baseAddress:t-BigInt(e.offset),start:t,end:BigInt(e.end)}}))}locateAddress(e){const t=BigInt(e),r=this._libRanges;let n=0,a=r.length-1;for(;n<=a;){const e=(n+a)/2|0;if(t>=r[e].end)n=e+1;else{if(!(t<r[e].start)){const n=e,a=t-r[n].baseAddress;return{lib:this._libs[n],relativeAddress:Number(a)}}a=e-1}}return{lib:null,relativeAddress:parseInt(e,16)}}}var j=r(720);function L(e,t,r){function n(t,r){if(t!==r)for(const n in e)if("length"!==n){const a=e[n],s=a[t];a[t]=a[r],a[r]=s}}return function e(a,s){if(a<s){const o=function(e,a,s){const o=t[e];let i=a,l=e;for(let e=a;e<=s;e++)r(t[e],o)<0&&(n(e,i),i===l&&(l=e),i++);return n(i,l),i}(a+s>>1,a,s);e(a,o-1),e(o+1,s)}}(0,e.length-1),e}function G(e){if(e){const t=e.split(" -> ");return t[t.length-1]}return e}function B(e){for(const t of e.threads)for(let e=0;e<t.markers.length;e++){const r=t.markers.data[e],n="default"===t.processType?0:t.processStartupTime;if(r){if("stack"in r&&r.stack&&r.stack.samples.data.length>0){const e=r.stack,t=e.samples.data[0][e.samples.schema.stack],a=e.samples.data[0][e.samples.schema.time];null!==t&&(r.cause={time:a+n,stack:t})}delete r.stack}}}function R(e){for(const t of[{name:"Idle",color:"transparent",subcategories:["Other"]},{name:"Other",color:"grey",subcategories:["Other"]},{name:"Layout",color:"purple",subcategories:["Other"]},{name:"JavaScript",color:"yellow",subcategories:["Other"]},{name:"GC / CC",color:"orange",subcategories:["Other"]},{name:"Network",color:"lightblue",subcategories:["Other"]},{name:"Graphics",color:"green",subcategories:["Other"]},{name:"DOM",color:"blue",subcategories:["Other"]}])-1===e.meta.categories.findIndex((e=>e.name===t.name))&&e.meta.categories.push(t);const t=e.meta.categories.findIndex((e=>"Other"===e.name)),r=new Map([["DOMEvent","DOM"],["Navigation::DOMComplete","DOM"],["Navigation::DOMInteractive","DOM"],["Navigation::Start","DOM"],["UserTiming","DOM"],["CC","GC / CC"],["GCMajor","GC / CC"],["GCMinor","GC / CC"],["GCSlice","GC / CC"],["Paint","Graphics"],["VsyncTimestamp","Graphics"],["CompositorScreenshot","Graphics"],["JS allocation","JavaScript"],["Styles","Layout"],["nsRefreshDriver::Tick waiting for paint","Layout"],["Navigation","Network"],["Network","Network"],["firstLoadURI","Other"],["IPC","Other"],["Text","Other"],["MainThreadLongTask","Other"],["FileIO","Other"],["Log","Other"],["PreferenceRead","Other"],["BHR-detected hang","Other"],["MainThreadLongTask","Other"]].map((([t,r])=>{const n=e.meta.categories.findIndex((e=>e.name===r));if(-1===n)throw new Error("Could not find a category index to map to.");return[t,n]})));for(const n of e.threads){const{markers:e,stringArray:a}=n;e.category||(e.category=[]);for(let n=0;n<e.length&&"number"!=typeof e.category[n];n++){const s=e.name[n],o=e.data[n];let i=a[s];o&&o.type&&(i="tracing"===o.type?o.category:o.type);let l=r.get(i);void 0===l&&(l=t),e.category[n]=l}}}const J={1:e=>{!function(e,t){if("undefined"!=typeof performance){const r=performance.now(),n=t(),a=Math.round(performance.now()-r),s=_[e]||0;return s<3&&(_[e]=1+s,function(e){const t=self.ga;t&&t("send",e)}({hitType:"timing",timingCategory:"timeCode",timingVar:e,timingValue:a})),n}t()}("sorting thread markers",(()=>{for(const t of e.threads)L(t.markers,t.markers.time,((e,t)=>e-t))}));for(const t of e.threads)"processType"in t||("Content"===t.name?(t.processType="tab",t.name="GeckoMain"):"Plugin"===t.name?t.processType="plugin":t.processType="default")},2:e=>{for(const r of e.threads)for(const n of r.libs)"debugName"in n||(n.debugName=n.pdbName,n.path=n.name,n.name=n.debugName.endsWith(".pdb")?n.debugName.substr(0,n.debugName.length-4):n.debugName,n.arch="x86_64-gcc3"===(t=e.meta.abi)?"x86_64":t,delete n.pdbName,delete n.pdbAge,delete n.pdbSignature);var t},3:e=>{for(const t of e.threads)for(const e of t.libs)e.debugPath=e.debugPath||""},4:e=>{e.threads.forEach((e=>{const{funcTable:t,stringArray:r,resourceTable:n}=e,a=o.M.withBackingArray(r),i={length:0,type:[],name:[],lib:[],icon:[],addonId:[],host:[]};function l(e,t){const r=i.length++;i.type[r]=s.AU.library,i.name[r]=e,i.lib[r]=t}function c(e,t){const r=i.length++;i.type[r]=s.AU.webhost,i.name[r]=e,i.host[r]=t}function u(e){const t=i.length++;i.type[t]=s.AU.url,i.name[t]=e}const m=new Map,d=new Map;for(let e=0;e<n.length;e++)if(n.type[e]===s.AU.library)m.set(e,i.length),l(n.name[e],n.lib[e]);else if(n.type[e]===s.AU.url){const t=a.getString(n.name[e]);let r,s,o=null;try{const e=new URL(t);if("http:"!==e.protocol&&"https:"!==e.protocol)throw new Error("not a webhost protocol");r=e.origin,s=e.host}catch(e){r=t,s=null}if(d.has(r))o=d.get(r);else{o=i.length,d.set(r,o);const e=a.indexForString(r);s?c(e,a.indexForString(s)):u(a.indexForString(t))}m.set(e,o)}t.fileName=[],t.lineNumber=[];for(let e=0;e<t.length;e++){const r=t.resource[e];m.has(r)&&(t.resource[e]=m.get(r));let n=null,s=null;if(t.isJS[e]){const r=a.getString(t.name[e]),o=/^(.*) \((.*):([0-9]+)\)$/.exec(r)||/^()(.*):([0-9]+)$/.exec(r);if(o){const r=G(o[2]);o[1]?t.name[e]=a.indexForString(o[1]):t.name[e]=a.indexForString(r),n=a.indexForString(r),s=0|Number(o[3])}}t.fileName[e]=n,t.lineNumber[e]=s}e.resourceTable=i}))},5:e=>{for(const t of e.threads)delete t.samples.frameNumber},6:e=>{for(const t of e.threads){const{stringArray:e,markers:r}=t,n=[];for(let t=0;t<r.length;t++){const a=e[r.name[t]],s=r.data[t];n[t]="DOMEvent"===a?{type:"DOMEvent",startTime:s.startTime,endTime:s.endTime,eventType:s.type,phase:s.phase}:s}t.markers.data=n}},7:e=>{for(const t of e.threads)t.pausedRanges=[],t.processStartupTime=0,t.processShutdownTime=null,t.registerTime=0,t.unregisterTime=null},8:e=>{for(const t of e.threads){if("default"===t.processType)continue;const{stringArray:e,markers:r}=t,n=[];for(let a=0;a<r.length;a++){const s=e[r.name[a]],o=r.data[a];"DOMEvent"===s&&o.timeStamp?n[a]={type:"DOMEvent",startTime:o.startTime,endTime:o.endTime,timeStamp:o.timeStamp+t.processStartupTime,eventType:o.eventType,phase:o.phase}:n[a]=o}t.markers.data=n}},9:e=>{function t(e){const t=function(e){if("timings"in e&&!("status"in e.timings)){const t=e.timings;t.status="completed",Array.isArray(t.sices)&&(t.slices_list=t.slices,t.slices=t.slices.length),t.allocated_bytes=1024*t.allocated*1024}return e}(e),r=t.timings;switch(r.status){case"completed":{const{totals:e,...a}=r,s={...a,phase_times:n(e),mmu_20ms:r.mmu_20ms/100,mmu_50ms:r.mmu_50ms/100};return{type:"GCMajor",startTime:t.startTime,endTime:t.endTime,timings:s}}case"aborted":return{type:"GCMajor",startTime:t.startTime,endTime:t.endTime,timings:{status:"aborted"}};default:throw console.log("Unknown GCMajor status"),new Error("Unknown GCMajor status")}}function r(e){if("nursery"in e){if("status"in e.nursery)return"no collection"===e.nursery.status&&(e.nursery.status="nursery empty"),Object.assign(e);const t=Object.assign(e,{nursery:Object.assign(e.nursery,{status:"complete",bytes_used:e.nursery.nursery_bytes,new_capacity:e.nursery.new_nursery_bytes,phase_times:e.nursery.timings})});return delete t.nursery.nursery_bytes,delete t.nursery.new_nursery_bytes,delete t.nursery.timings,t}return e}function n(e){const t={};for(const r in e)t[r]=1e3*e[r];return t}for(const a of e.threads)for(let e=0;e<a.markers.length;e++){let s=a.markers.data[e];if(s){switch(s.type){case"GCMinor":s=r(s);break;case"GCSlice":s.timings&&s.timings.times&&(s.timings.phase_times=n(s.timings.times),delete s.timings.times);break;case"GCMajor":s=t(s)}a.markers.data[e]=s}}},10:e=>{B(e)},11:e=>{for(const t of e.threads){const{stringArray:e,markers:r}=t;if(0===r.length)continue;const n=[];for(let t=0;t<r.length;t++){const a=e[r.name[t]],s=r.data[t];"DOMEvent"===a&&(r.data[t]={type:"tracing",category:"DOMEvent",timeStamp:s.timeStamp,interval:"start",eventType:s.eventType,phase:s.phase},n.push({data:{type:"tracing",category:"DOMEvent",timeStamp:s.timeStamp,interval:"end",eventType:s.eventType,phase:s.phase},time:s.endTime,name:r.name[t]}))}if(n.length>0){n.sort(((e,t)=>e.time-t.time));const e={length:0,name:[],time:[],data:[]};let a=0,s=r.time[0],o=0,i=n[0].time;for(;a<r.length||o<n.length;)s<=i?(e.name.push(r.name[a]),e.time.push(r.time[a]),e.data.push(r.data[a]),e.length++,a++,s=a<r.length?r.time[a]:1/0):(e.name.push(n[o].name),e.time.push(n[o].time),e.data.push(n[o].data),e.length++,o++,i=o<n.length?n[o].time:1/0);t.markers=e}}},12:e=>{e.meta.categories=[{name:"Idle",color:"transparent"},{name:"Other",color:"grey"},{name:"JavaScript",color:"yellow"},{name:"Layout",color:"purple"},{name:"Graphics",color:"green"},{name:"DOM",color:"blue"},{name:"GC / CC",color:"orange"},{name:"Network",color:"lightblue"}];const t={16:1,32:3,64:2,128:6,256:6,512:7,1024:4,2048:1,4096:1},r=new Map([["-[GeckoNSApplication nextEventMatchingMask:untilDate:inMode:dequeue:]",0],["base::MessagePumpDefault::Run(base::MessagePump::Delegate*)",0],["mozilla::widget::WinUtils::WaitForMessage(unsigned long)",0],["mozilla::ThreadEventQueue<mozilla::PrioritizedEventQueue<mozilla::LabeledEventQueue> >::GetEvent(bool,mozilla::EventPriority *)",0],["mozilla::ThreadEventQueue<mozilla::PrioritizedEventQueue<mozilla::EventQueue> >::GetEvent(bool,mozilla::EventPriority *)",0],["mozilla::ThreadEventQueue<mozilla::EventQueue>::GetEvent(bool,mozilla::EventPriority *)",0],["mozilla::layers::PaintThread::AsyncPaintContents(mozilla::layers::CompositorBridgeChild *,mozilla::layers::CapturedPaintState *,bool (*)(mozilla::layers::CapturedPaintState *))",4],["PresShell::DoFlushPendingNotifications InterruptibleLayout",3],["nsRefreshDriver::Tick",3],["nsLayoutUtils::GetFrameForPoint",3],["nsAppShell::ProcessGeckoEvents",1],["PollWrapper(_GPollFD*, unsigned int, int)",0],["mozilla::image::DecodePoolImpl::PopWorkLocked(bool)",0],["nsCCUncollectableMarker::Observe(nsISupports*, char const*, char16_t const*)",6],["g_main_context_dispatch",1],["Events::ProcessGeckoEvents",1],["widget::ChildView::drawUsingOpenGL",1],["nsContentSink::StartLayout(bool)",3],["Paint::PresShell::Paint",4],["JS::EvaluateString",2],["js::RunScript",2]]),n=new Map([["PresShell::DoFlushPendingNotifications",3],["PresShell::DoReflow",3],["layout::DoReflow",3],["JS::Compile",2]]);function a(e){const t=r.get(e);return void 0!==t?t:n.get(function(e){const t=e.indexOf(" ");return-1===t?e:e.substr(0,t)}(e))}const s=/^(get |set )?\w+(\.\w+| constructor)$/;for(const r of e.threads){const{frameTable:e,funcTable:n,stringArray:o}=r;for(let r=0;r<e.length;r++){const i=e.func[r],l=o[n.name[i]],c=a(l);if(void 0!==c)e.category[r]=c;else{const a=e.category[r];if(null!==a)if(!n.isJS[i]&&s.test(l))e.category[r]=5;else{const n=a in t?t[a]:1;e.category[r]=n}}}}},13:e=>{const{meta:t,threads:r}=e,n=t.categories.findIndex((e=>"grey"===e.color));for(const e of r){const{stackTable:t,frameTable:r}=e;t.category=new Array(t.length);for(let e=0;e<t.length;e++){const a=t.frame[e],s=r.category[a];if(null!==s)t.category[e]=s;else{const r=t.prefix[e];t.category[e]=null!==r?t.category[r]:n}}}},14:e=>{const{threads:t}=e;for(let e=0;e<t.length;e++){const r=t[e];null!==r.pid&&void 0!==r.pid||(r.pid=`Unknown Process ${e+1}`)}},15:e=>{for(const t of e.threads){t.frameTable.column=new Array(t.frameTable.length);for(let e=0;e<t.frameTable.length;e++)t.frameTable.column[e]=null}},16:e=>{for(const t of e.threads){const{stringArray:e,markers:r}=t,n=[];for(let t=0;t<r.length;t++){const a=e[r.name[t]],s=r.data[t];switch(a){case"VsyncTimestamp":n[t]={type:"VsyncTimestamp",vsync:s.vsync};break;case"LayerTranslation":n[t]={type:"LayerTranslation",layer:s.layer,x:s.x,y:s.y};break;case"CompositorScreenshot":n[t]={type:"CompositorScreenshot",url:s.url,windowID:s.windowID,windowWidth:s.windowWidth,windowHeight:s.windowHeight};break;default:n[t]=s}}t.markers.data=n}},17:e=>{const t=/^(get |set )?\w+(\.\w+| constructor)$/;for(const r of e.threads){const{funcTable:e,stringArray:n}=r,a=o.M.withBackingArray(n);e.relevantForJS=new Array(e.length);for(let r=0;r<e.length;r++){const n=a.getString(e.name[r]);n.startsWith("AutoEntryScript ")?(e.name[r]=a.indexForString(n.substring(16)),e.relevantForJS[r]=!0):e.relevantForJS[r]=t.test(n)}}},18:e=>{for(const t of e.threads){const{funcTable:e,stringArray:r}=t,n=o.M.withBackingArray(r);e.columnNumber=[];for(let r=0;r<t.funcTable.length;r++)if(e.columnNumber[r]=null,e.isJS[r]){const t=e.fileName[r];if(null!==t){const a=n.getString(t),s=/^(.*):([0-9]+)$/.exec(a);s&&(e.columnNumber[r]=e.lineNumber[r],e.fileName[r]=n.indexForString(s[1]),e.lineNumber[r]=parseInt(s[2],10))}}}},19:e=>{for(const t of e.threads){const e=t.markers,r=t.processStartupTime;for(let n=0;n<t.markers.length;n++){const t=e.data[n];t&&"type"in t&&"Network"===t.type&&(t.domainLookupStart&&(t.domainLookupStart+=r),t.domainLookupEnd&&(t.domainLookupEnd+=r),t.connectStart&&(t.connectStart+=r),t.tcpConnectEnd&&(t.tcpConnectEnd+=r),t.secureConnectionStart&&(t.secureConnectionStart+=r),t.connectEnd&&(t.connectEnd+=r),t.requestStart&&(t.requestStart+=r),t.responseStart&&(t.responseStart+=r),t.responseEnd&&(t.responseEnd+=r))}}},20:e=>{},21:e=>{B(e)},22:e=>{for(const t of e.threads){const{stringArray:e}=t,r=o.M.withBackingArray(e);if(!r.hasString("DiskIO"))continue;const n=r.indexForString("FileIO");for(let e=0;e<t.markers.length;e++){const r=t.markers.data[e];r&&"DiskIO"===r.type&&(r.type="FileIO",t.markers.name[e]=n)}}},23:e=>{for(const t of e.meta.categories)t.subcategories=["Other"];for(const t of e.threads){const{frameTable:e,stackTable:r}=t;e.subcategory=e.category.map((e=>null===e?null:0)),r.subcategory=r.category.map((e=>null===e?null:0))}},24:e=>{R(e)},25:e=>{if(e.pages&&e.pages.length>0){const t=new Map,r=new Map;let n=1,a=1;for(const s of e.pages){t.set(`d${s.docshellId}h${s.historyId}`,a);let e=r.get(s.docshellId);e||(e=n++,r.set(s.docshellId,e)),s.browsingContextID=e,s.innerWindowID=a,s.embedderInnerWindowID=0,a++,delete s.docshellId,delete s.historyId,delete s.isSubFrame}for(const r of e.threads){const{markers:e}=r;e.data=e.data.map((e=>{if(e&&void 0!==e.docShellId&&void 0!==e.docshellHistoryId){const r=t.get(`d${e.docShellId}h${e.docshellHistoryId}`);void 0===r?console.error("No page found with given docShellId and historyId"):e.innerWindowID=r,delete e.docShellId,delete e.docshellHistoryId}return e}))}}},26:e=>{if(e.counters&&e.counters.length>0)for(const t of e.counters)t.sampleGroups=[t.sampleGroups]},27:e=>{for(const t of e.threads){const{frameTable:e}=t;e.innerWindowID=new Array(e.length).fill(0)}},28:e=>{for(const t of e.threads){const{markers:r}=t;if(null===r.category[0])return void R(e)}},29:e=>{for(const t of e.threads)t.samples.duration&&(t.samples.weightType="samples",t.samples.weight=t.samples.duration,delete t.samples.duration),t.nativeAllocations&&(t.nativeAllocations.weightType="bytes",t.nativeAllocations.weight=t.nativeAllocations.duration,delete t.nativeAllocations.duration),t.jsAllocations&&(t.jsAllocations.weightType="bytes",t.jsAllocations.weight=t.jsAllocations.duration,delete t.jsAllocations.duration),t.samples.weight||(t.samples.weight=null),t.samples.weightType||(t.samples.weightType="samples")},30:e=>{for(const{markers:t}of e.threads){const e=t.time,r=[],n=[],a=[];delete t.time,t.startTime=r,t.endTime=n,t.phase=a;for(let s=0;s<t.length;s++){const o=t.data[s],i=e[s];let l=i,c=null,u=0;if(o){const{startTime:e,endTime:t,type:r,interval:n}=o;"tracing"===r?"start"===n?(l=i,c=null,u=2):(l=null,c=i,u=3):e!==t&&"number"==typeof e&&"number"==typeof t&&(l=e,c=t,u=1),"IPC"!==o.type&&"Network"!==o.type&&(delete o.startTime,delete o.endTime)}r.push(l),n.push(c),a.push(u)}}},31:e=>{for(const{markers:t}of e.threads)for(let e=0;e<t.length;e++){const r=t.data[e];if(r){const{type:n,interval:a}=r;"tracing"===n&&"start"!==a&&"end"!==a&&(t.phase[e]=0,t.startTime[e]=t.endTime[e],t.endTime[e]=null)}}},32:e=>{for(const{markers:t}of e.threads)for(let e=0;e<t.length;e++){const r=t.data[e];if(r&&"tracing"===r.type&&"DOMEvent"===r.category){const n=t.startTime[e];r.type="DOMEvent",void 0!==r.timeStamp&&null!==n&&(r.latency=n-r.timeStamp),delete r.timeStamp}}},33:e=>{e.meta.markerSchema=[{name:"GCMajor",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"GCMinor",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"GCSlice",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"CC",tooltipLabel:"Cycle Collect",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"FileIO",display:["marker-chart","marker-table"],data:[{key:"operation",label:"Operation",format:"string",searchable:!0},{key:"source",label:"Source",format:"string",searchable:!0},{key:"filename",label:"Filename",format:"file-path",searchable:!0}]},{name:"MediaSample",display:["marker-chart","marker-table"],data:[{key:"sampleStartTimeUs",label:"Sample start time",format:"microseconds"},{key:"sampleEndTimeUs",label:"Sample end time",format:"microseconds"}]},{name:"Styles",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"elementsTraversed",label:"Elements traversed",format:"integer"},{key:"elementsStyled",label:"Elements styled",format:"integer"},{key:"elementsMatched",label:"Elements matched",format:"integer"},{key:"stylesShared",label:"Styles shared",format:"integer"},{key:"stylesReused",label:"Styles reused",format:"integer"}]},{name:"PreferenceRead",display:["marker-chart","marker-table"],data:[{key:"prefName",label:"Name",format:"string"},{key:"prefKind",label:"Kind",format:"string"},{key:"prefType",label:"Type",format:"string"},{key:"prefValue",label:"Value",format:"string"}]},{name:"UserTiming",tooltipLabel:"{marker.data.name}",chartLabel:"{marker.data.name}",tableLabel:"{marker.data.name}",display:["marker-chart","marker-table"],data:[{label:"Marker",value:"UserTiming"},{key:"entryType",label:"Entry Type",format:"string"},{label:"Description",value:"UserTiming is created using the DOM APIs performance.mark() and performance.measure()."}]},{name:"Text",tableLabel:"{marker.name} — {marker.data.name}",chartLabel:"{marker.name} — {marker.data.name}",display:["marker-chart","marker-table"],data:[{key:"name",label:"Details",format:"string"}]},{name:"Log",display:["marker-table"],tableLabel:"({marker.data.module}) {marker.data.name}",data:[{key:"module",label:"Module",format:"string"},{key:"name",label:"Name",format:"string"}]},{name:"DOMEvent",tooltipLabel:"{marker.data.eventType} — DOMEvent",tableLabel:"{marker.data.eventType}",chartLabel:"{marker.data.eventType}",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"latency",label:"Latency",format:"duration"}]},{name:"Paint",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"Navigation",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"Layout",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"IPC",tooltipLabel:"IPC — {marker.data.niceDirection}",tableLabel:"{marker.name} — {marker.data.messageType} — {marker.data.niceDirection}",chartLabel:"{marker.data.messageType}",display:["marker-chart","marker-table","timeline-ipc"],data:[{key:"messageType",label:"Type",format:"string"},{key:"sync",label:"Sync",format:"string"},{key:"sendThreadName",label:"From",format:"string"},{key:"recvThreadName",label:"To",format:"string"}]},{name:"RefreshDriverTick",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"name",label:"Tick Reasons",format:"string"}]},{name:"Network",display:["marker-table"],data:[]}]},34:e=>{for(const t of e.threads){const e=t.processStartupTime,{markers:r}=t;for(const t of r.data)t&&"tracing"!==t.type&&"Styles"!==t.type&&t.cause&&void 0!==t.cause.time&&(t.cause.time+=e)}},35:e=>{if(e.meta.configuration&&e.meta.configuration.activeBrowsingContextID&&(e.meta.configuration.activeTabID=e.meta.configuration.activeBrowsingContextID,delete e.meta.configuration.activeBrowsingContextID),e.pages&&e.pages.length>0)for(const t of e.pages)t.tabID=t.browsingContextID,delete t.browsingContextID},36:e=>{for(const t of e.threads){const e={libIndex:[],address:[],name:[],length:0},{frameTable:r,funcTable:n,resourceTable:a}=t,o=new Map;for(let t=0;t<n.length;t++){const r=n.resource[t];if(-1===r)continue;if(a.type[r]!==s.AU.library)continue;const i=a.lib[r];if(null==i||-1===i)continue;const l=n.address[t],c=e.length;e.libIndex.push(i),e.address.push(-1===l?null:l),e.name.push(n.name[t]),e.length++,o.set(t,c)}delete n.address,r.nativeSymbol=r.func.map((e=>o.get(e)??null)),t.nativeSymbols=e}},37:e=>{for(const t of e.threads)"Java Main Thread"===t.name&&(t.name="AndroidUI (JVM)")},38:e=>{for(const t of e.threads){const e=new Set,r=new Set,{samples:n,markers:a,jsAllocations:s,nativeAllocations:o,stackTable:i,frameTable:l}=t;for(let t=0;t<n.length;t++){const r=n.stack[t];null!==r&&e.add(r)}for(let e=0;e<a.length;e++){const t=a.data[e];if(t&&t.cause){const e=t.cause.stack;null!==e&&r.add(e)}}if(void 0!==s)for(let e=0;e<s.length;e++){const t=s.stack[e];null!==t&&r.add(t)}if(void 0!==o)for(let e=0;e<o.length;e++){const t=o.stack[e];null!==t&&r.add(t)}const c=new Uint32Array(l.length),u=new Set;for(const t of e){const e=i.frame[t];c[e]=e,-1!==l.address[e]&&u.add(e)}const m=new Map,d=new Set;for(const e of r){const t=i.frame[e],r=l.address[t];-1!==r&&m.set(t,r)}for(let e=0;e<i.length;e++){const t=i.prefix[e];if(null===t||d.has(t))continue;d.add(t);const r=i.frame[t],n=l.address[r];-1!==n&&m.set(r,n)}if(0===u.size&&0===m.size)continue;for(const[e,t]of m){if(u.has(e)){const r=l.length;l.address.push(t),l.category.push(l.category[e]),l.subcategory.push(l.subcategory[e]),l.func.push(l.func[e]),l.nativeSymbol.push(l.nativeSymbol[e]),l.innerWindowID.push(l.innerWindowID[e]),l.implementation.push(l.implementation[e]),l.line.push(l.line[e]),l.column.push(l.column[e]),l.optimizations.push(l.optimizations[e]),l.length++,c[e]=r}l.address[e]=t-1}const h={frame:[],prefix:[],category:[],subcategory:[],length:0},f=new Map,p=new Map,g=new Uint32Array(i.length);for(let t=0;t<i.length;t++){const n=i.frame[t],a=i.category[t],s=i.subcategory[t],o=i.prefix[t],l=null===o?null:g[o];if(d.has(t)||r.has(t)){const e=h.length;h.frame.push(n),h.category.push(a),h.subcategory.push(s),h.prefix.push(l),h.length++,g[t]=e,p.set(t,e)}if(e.has(t)){const e=c[n],r=h.length;h.frame.push(e),h.category.push(a),h.subcategory.push(s),h.prefix.push(l),h.length++,f.set(t,r)}}t.stackTable=h,n.stack=n.stack.map((e=>null===e?null:f.get(e)??null)),a.data.forEach((e=>{e&&"cause"in e&&e.cause&&(e.cause.stack=p.get(e.cause.stack))})),void 0!==s&&(s.stack=s.stack.map((e=>null===e?null:p.get(e)??null))),void 0!==o&&(o.stack=o.stack.map((e=>null===e?null:p.get(e)??null)))}},39:e=>{for(const t of e.threads)t.samples.threadCPUDelta&&(t.samples.threadCPUDelta.some((e=>null!==e))||delete t.samples.threadCPUDelta)},40:e=>{for(const t of e.threads)t.frameTable.inlineDepth=Array(t.frameTable.length).fill(0)},41:e=>{const t=[],r=new Map;for(const n of e.threads){const{libs:e,resourceTable:a,nativeSymbols:s,stringArray:i}=n,l=o.M.withBackingArray(i),c=new Map;delete n.libs;const u=n=>{let a=c.get(n);if(void 0===a){const s=e[n],{debugName:o,breakpadId:i}=s,l=`${o}/${i}`;if(a=r.get(l),void 0===a){a=t.length;const{arch:e,name:n,path:c,debugPath:u,codeId:m}=s;t.push({arch:e,name:n,path:c,debugName:o,debugPath:u,breakpadId:i,codeId:m??null}),r.set(l,a)}c.set(n,a)}return a};for(let e=0;e<a.length;e++){const t=a.name[e];-1!==t&&null!=t||(a.name[e]=l.indexForString("<unnamed resource>"));const r=a.host[e];-1!==r&&void 0!==r||(a.host[e]=null);const n=a.lib[e];if(null==n||-1===n){a.lib[e]=null;continue}const s=u(n);a.lib[e]=s}for(let e=0;e<s.length;e++){const t=u(s.libIndex[e]);s.libIndex[e]=t}}e.libs=t},42:e=>{for(const t of e.threads){const{nativeSymbols:e}=t;e.functionSize=Array(e.length).fill(null)}},43:e=>{},44:e=>{for(const t of e.meta.markerSchema){let e;switch(t.name){case"FileIO":t.data.push({key:"threadId",label:"Thread ID",format:"string",searchable:!0}),e=[];break;case"Log":e=["name","module"];break;case"DOMEvent":t.data.push({key:"eventType",label:"Event Type",format:"string",searchable:!0}),e=["target"];break;case"TraceEvent":e=["name1","name2","val1","val2"];break;default:e=["name","category"]}for(const r of t.data)e.includes(r.key)&&(r.searchable=!0)}},45:e=>{for(const t of e.threads)delete t.frameTable.optimizations},46:e=>{for(const t of e.threads)t.isMainThread="GeckoMain"===t.name||"string"==typeof t.pid||String(t.pid)===t.tid},47:e=>{for(const t of e.threads){t.pid=`${t.pid}`;for(const e of t.markers.data)e&&"IPC"===e.type&&(e.otherPid=`${e.otherPid}`)}if(e.counters)for(const t of e.counters)t.pid=`${t.pid}`;if(e.profilerOverhead)for(const t of e.profilerOverhead)t.pid=`${t.pid}`},48:e=>{if(e.counters&&e.counters.length>0)for(const t of e.counters)t.samples=t.sampleGroups[0].samples,delete t.sampleGroups},49:e=>{},50:e=>{},51:e=>{},52:e=>{const t=new Set(e.meta.markerSchema.map((e=>e.name))),r="tracingCCFrom52Upgrader",n=t.has("CC");let a=!1,s=!1;for(const t of e.threads){const{markers:e}=t;for(let t=0;t<e.length;t++){const o=e.data[t];o&&"tracing"===o.type&&o.category&&(a=!0,n&&"CC"===o.category&&(o.type=r,s=!0,o.interval&&delete o.interval))}}a&&!t.has("tracing")&&e.meta.markerSchema.push({name:"tracing",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]}),s&&e.meta.markerSchema.push({name:r,display:["marker-chart","marker-table","timeline-memory"],data:[{key:"category",label:"Type",format:"string"}]})},53:e=>{for(const t of e.threads){const{frameTable:e,stackTable:r}=t;if(!("category"in e)){e.category=[],e.subcategory=[];for(let t=0;t<e.length;t++)e.category[t]=null,e.subcategory[t]=null;for(let t=0;t<r.length;t++){const n=r.frame[t];e.category[n]=r.category[t],e.subcategory[n]=r.subcategory[t]}}delete r.category,delete r.subcategory}}};function W(e){if(e&&"object"==typeof e&&e.meta&&"object"==typeof e.meta)return e.meta;throw new Error("Could not find the meta property on a profile.")}const z={1:()=>{throw new Error("Gecko profiles without version numbers are very old and no conversion code has been written for that version of the profile format.")},2:()=>{throw new Error("Gecko profile version 1 is very old and no conversion code has been written for that version of the profile format.")},3:()=>{throw new Error("Gecko profile version 2 is very old and no conversion code has been written for that version of the profile format.")},4:e=>{!function e(t){t.libs=JSON.parse(t.libs).map((e=>{if("breakpadId"in e)e.debugName=e.name.substr(e.name.lastIndexOf("/")+1);else{e.debugName=e.pdbName;const t=e.pdbSignature.replace(/[{}-]/g,"").toUpperCase();e.breakpadId=t+e.pdbAge}var r;return delete e.pdbName,delete e.pdbAge,delete e.pdbSignature,e.path=e.name,e.name=e.debugName.endsWith(".pdb")?e.debugName.substr(0,e.debugName.length-4):e.debugName,e.arch="x86_64-gcc3"===(r=t.meta.abi)?"x86_64":r,e.debugPath="",e})).sort(((e,t)=>e.start-t.start));for(let r=0;r<t.threads.length;r++)if("string"==typeof t.threads[r]){const n=JSON.parse(t.threads[r]);e(n),t.threads[r]=JSON.stringify(n)}else{const e=t.threads[r];"processType"in e||("Content"===e.name?(e.processType="tab",e.name="GeckoMain"):"Plugin"===e.name?e.processType="plugin":e.processType="default")}t.meta.version=4}(e)},5:e=>{!function e(t){const r=t.threads.map((t=>{if("string"==typeof t){const r=JSON.parse(t);return e(r),{type:"process",data:r}}return{type:"thread",data:t}}));t.processes=r.filter((e=>"process"===e.type)).map((e=>e.data)),t.threads=r.filter((e=>"thread"===e.type)).map((e=>e.data)),t.meta.version=5}(e)},6:e=>{!function e(t){for(const e of t.threads){delete e.samples.schema.frameNumber;for(let t=0;t<e.samples.data.length;t++)e.samples.data[t].splice(5)}for(const r of t.processes)e(r)}(e)},7:e=>{!function e(t){for(const e of t.threads){const t=e.markers.schema.name,r=e.markers.schema.data;for(let n=0;n<e.markers.data.length;n++)if("DOMEvent"===e.stringTable[e.markers.data[n][t]]){const t=e.markers.data[n][r];t.eventType=t.type,t.type="DOMEvent"}}for(const r of t.processes)e(r)}(e)},8:e=>{!function e(t){t.pausedRanges=[],t.meta.shutdownTime=null;for(const e of t.threads)e.registerTime=0,e.unregisterTime=null;for(const r of t.processes)e(r)}(e)},9:e=>{function t(e){if("timings"in e&&!("status"in e.timings)){const t=e.timings;t.status="completed",Array.isArray(t.sices)&&(t.slices_list=t.slices,t.slices=t.slices.length),t.allocated_bytes=1024*t.allocated*1024}return e}function r(e){if("nursery"in e){if("status"in e.nursery)return"no collection"===e.nursery.status&&(e.nursery.status="nursery empty"),Object.assign(e);const t=Object.assign(e,{nursery:Object.assign(e.nursery,{status:"complete",bytes_used:e.nursery.nursery_bytes,new_capacity:e.nursery.new_nursery_bytes,phase_times:e.nursery.timings})});return delete t.nursery.nursery_bytes,delete t.nursery.new_nursery_bytes,delete t.nursery.timings,t}return e}!function e(n){for(const e of n.threads){const n=e.markers.schema.data;for(let a=0;a<e.markers.data.length;a++){let s=e.markers.data[a][n];if(s){switch(s.type){case"GCMinor":s=r(s);break;case"GCMajor":s=t(s)}e.markers.data[a][n]=s}}}for(const t of n.processes)e(t)}(e)},10:e=>{!function e(t){for(const e of t.threads){const{markers:t}=e,r=t.schema.name,n=t.schema.data,a=t.schema.time,s=[];for(let o=0;o<t.data.length;o++){const i=t.data[o],l=e.stringTable[i[r]],c=i[n];if("DOMEvent"===l&&"tracing"!==c.type){const e=[];e[n]={type:"tracing",category:"DOMEvent",timeStamp:c.timeStamp,interval:"end",eventType:c.eventType,phase:c.phase},e[a]=c.endTime,e[r]=i[r],s.push(e),i[a]=c.startTime,i[n]={type:"tracing",category:"DOMEvent",timeStamp:c.timeStamp,interval:"start",eventType:c.eventType,phase:c.phase}}}t.data=t.data.concat(s)}for(const r of t.processes)e(r)}(e)},11:e=>{let t=0;!function e(r){for(const e of r.threads)null!==e.pid&&void 0!==e.pid||(e.pid="Unknown Process "+ ++t);for(const t of r.processes)e(t)}(e);const r=[{name:"Idle",color:"transparent"},{name:"Other",color:"grey"},{name:"JavaScript",color:"yellow"},{name:"Layout",color:"purple"},{name:"Graphics",color:"green"},{name:"DOM",color:"blue"},{name:"GC / CC",color:"orange"},{name:"Network",color:"lightblue"}],n={16:1,32:3,64:2,128:6,256:6,512:7,1024:4,2048:1,4096:1};!function e(t){t.meta.categories=r;for(const e of t.threads){const t=e.frameTable.schema.category;for(const r of e.frameTable.data)t in r&&null!==r[t]&&(r[t]in n?r[t]=n[r[t]]:r[t]=1)}for(const r of t.processes)e(r)}(e)},12:e=>{!function e(t){for(const e of t.threads){const t=e.frameTable.schema.category;for(const r of e.frameTable.data)r.hasOwnProperty(t)&&(r[5]=r[4],r[4]=null);e.frameTable.schema.category=5,e.frameTable.schema.column=4}for(const r of t.processes)e(r)}(e)},13:e=>{!function e(t){for(const e of t.threads){const t=e.markers.schema.name,r=e.markers.schema.data;for(let n=0;n<e.markers.data.length;n++){const a=e.stringTable[e.markers.data[n][t]],s=e.markers.data[n][r];switch(a){case"VsyncTimestamp":case"LayerTranslation":case"CompositorScreenshot":s.type=a,delete s.category}}}for(const r of t.processes)e(r)}(e)},14:e=>{const t=/^(get |set )?\w+(\.\w+| constructor)$/;!function e(r){for(const e of r.threads){e.frameTable.schema={location:0,relevantForJS:1,implementation:2,optimizations:3,line:4,column:5,category:6};const r=e.frameTable.schema.location,n=e.frameTable.schema.relevantForJS,a=o.M.withBackingArray(e.stringTable);for(let s=0;s<e.frameTable.data.length;s++){const o=e.frameTable.data[s];o.splice(n,0,!1);const i=a.getString(o[r]);i.startsWith("AutoEntryScript ")?(o[n]=!0,o[r]=a.indexForString(i.substring(16))):o[n]=t.test(i)}}for(const t of r.processes)e(t)}(e)},15:e=>{!function e(t){for(const e of t.threads){const t=o.M.withBackingArray(e.stringTable);if(!t.hasString("DiskIO"))continue;const r=t.indexForString("FileIO"),n=e.markers.schema.name,a=e.markers.schema.data;for(let t=0;t<e.markers.data.length;t++){const s=e.markers.data[t],o=s[a];o&&"DiskIO"===o.type&&(s[n]=r,o.type="FileIO")}}for(const r of t.processes)e(r)}(e)},16:e=>{!function e(t){for(const e of t.meta.categories)e.subcategories=["Other"];for(const e of t.threads){const{frameTable:t}=e;t.schema.subcategory=7;for(let e=0;e<t.data.length;e++)t.data[e][t.schema.category]&&(t.data[e][t.schema.subcategory]=0)}for(const r of t.processes)e(r)}(e);for(const t of[{name:"Idle",color:"transparent",subcategories:["Other"]},{name:"Other",color:"grey",subcategories:["Other"]},{name:"Layout",color:"purple",subcategories:["Other"]},{name:"JavaScript",color:"yellow",subcategories:["Other"]},{name:"GC / CC",color:"orange",subcategories:["Other"]},{name:"Network",color:"lightblue",subcategories:["Other"]},{name:"Graphics",color:"green",subcategories:["Other"]},{name:"DOM",color:"blue",subcategories:["Other"]}])-1===e.meta.categories.findIndex((e=>e.name===t.name))&&e.meta.categories.push(t);const t=e.meta.categories.findIndex((e=>"Other"===e.name)),r=new Map([["DOMEvent","DOM"],["Navigation::DOMComplete","DOM"],["Navigation::DOMInteractive","DOM"],["Navigation::Start","DOM"],["UserTiming","DOM"],["CC","GC / CC"],["GCMajor","GC / CC"],["GCMinor","GC / CC"],["GCSlice","GC / CC"],["Paint","Graphics"],["VsyncTimestamp","Graphics"],["CompositorScreenshot","Graphics"],["JS allocation","JavaScript"],["Styles","Layout"],["nsRefreshDriver::Tick waiting for paint","Layout"],["Navigation","Network"],["Network","Network"],["firstLoadURI","Other"],["IPC","Other"],["Text","Other"],["MainThreadLongTask","Other"],["FileIO","Other"],["Log","Other"],["PreferenceRead","Other"],["BHR-detected hang","Other"],["MainThreadLongTask","Other"]].map((([t,r])=>{const n=e.meta.categories.findIndex((e=>e.name===r));if(-1===n)throw new Error("Could not find a category index to map to.");return[t,n]})));!function e(n){for(const e of n.threads){const{markers:n,stringTable:a}=e;if(void 0!==n.schema.category)return;n.schema.category=3;for(let e=0;e<n.data.length;e++){const s=n.data[e][n.schema.name],o=n.data[e][n.schema.data];let i=a[s];o&&o.type&&(i="tracing"===o.type?o.category:o.type);let l=r.get(i);void 0===l&&(l=t),n.data[e][n.schema.category]=l}}for(const t of n.processes)e(t)}(e)},17:e=>{let t=1,r=1;!function e(n){if(n.pages&&n.pages.length>0){const e=new Map,a=new Map;for(const s of n.pages){e.set(`d${s.docshellId}h${s.historyId}`,r);let n=a.get(s.docshellId);n||(n=t++,a.set(s.docshellId,n)),s.browsingContextID=n,s.innerWindowID=r,s.embedderInnerWindowID=0,r++,delete s.docshellId,delete s.historyId,delete s.isSubFrame}for(const t of n.threads){const{markers:r}=t,n=r.schema.data;for(let r=0;r<t.markers.data.length;r++){const a=t.markers.data[r][n];if(a&&void 0!==a.docShellId&&void 0!==a.docshellHistoryId){const t=e.get(`d${a.docShellId}h${a.docshellHistoryId}`);void 0===t?console.error("No page found with given docShellId and historyId"):a.innerWindowID=t,delete a.docShellId,delete a.docshellHistoryId}}}}for(const t of n.processes)e(t)}(e)},18:e=>{!function e(t){if(t.counters&&t.counters.length>0)for(const e of t.counters)"samples"in e.sample_groups?e.sample_groups=[e.sample_groups]:e.sample_groups=[];for(const r of t.processes)e(r)}(e)},19:e=>{!function e(t){for(const e of t.threads){const{frameTable:t}=e;t.schema={location:0,relevantForJS:1,innerWindowID:2,implementation:3,optimizations:4,line:5,column:6,category:7,subcategory:8};for(let e=0;e<t.data.length;e++){const r=t.schema.innerWindowID;t.data[e].splice(r,0,0)}}for(const r of t.processes)e(r)}(e)},20:e=>{!function e(t){for(const e of t.threads){const{markers:t}=e,r=t.schema,n={name:0,startTime:1,endTime:2,phase:3,category:4,data:5};t.schema=n;for(let e=0;e<t.data.length;e++){const a=t.data[e],s=a[r.name],o=a[r.time],i=a[r.category],l=a[r.data];let c=o,u=null,m=0;if(l){const{startTime:e,endTime:t,type:r,interval:n}=l;"tracing"===r?"start"===n?(c=o,u=null,m=2):"end"===n&&(c=null,u=o,m=3):e!==t&&"number"==typeof e&&"number"==typeof t&&(c=e,u=t,m=1),"IPC"!==l.type&&"Network"!==l.type&&(delete l.startTime,delete l.endTime)}const d=[];d[n.name]=s,d[n.startTime]=c,d[n.endTime]=u,d[n.phase]=m,d[n.category]=i,d[n.data]=l,t.data[e]=d}}for(const r of t.processes)e(r)}(e)},21:e=>{!function e(t){for(const e of t.threads){const{markers:t}=e;for(let e=0;e<t.data.length;e++){const r=t.data[e],n=r[t.schema.data];if(n&&"tracing"===n.type&&"DOMEvent"===n.category){const e=r[t.schema.startTime];n.type="DOMEvent",void 0!==n.timeStamp&&(n.latency=e-n.timeStamp),delete n.timeStamp}}}for(const r of t.processes)e(r)}(e)},22:e=>{const t=e;t.meta.markerSchema=[{name:"GCMajor",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"GCMinor",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"GCSlice",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"CC",tooltipLabel:"Cycle Collect",display:["marker-chart","marker-table","timeline-memory"],data:[]},{name:"FileIO",display:["marker-chart","marker-table"],data:[{key:"operation",label:"Operation",format:"string",searchable:!0},{key:"source",label:"Source",format:"string",searchable:!0},{key:"filename",label:"Filename",format:"file-path",searchable:!0}]},{name:"MediaSample",display:["marker-chart","marker-table"],data:[{key:"sampleStartTimeUs",label:"Sample start time",format:"microseconds"},{key:"sampleEndTimeUs",label:"Sample end time",format:"microseconds"}]},{name:"Styles",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"elementsTraversed",label:"Elements traversed",format:"integer"},{key:"elementsStyled",label:"Elements styled",format:"integer"},{key:"elementsMatched",label:"Elements matched",format:"integer"},{key:"stylesShared",label:"Styles shared",format:"integer"},{key:"stylesReused",label:"Styles reused",format:"integer"}]},{name:"PreferenceRead",display:["marker-chart","marker-table"],data:[{key:"prefName",label:"Name",format:"string"},{key:"prefKind",label:"Kind",format:"string"},{key:"prefType",label:"Type",format:"string"},{key:"prefValue",label:"Value",format:"string"}]},{name:"UserTiming",tooltipLabel:"{marker.data.name}",chartLabel:"{marker.data.name}",tableLabel:"{marker.data.name}",display:["marker-chart","marker-table"],data:[{label:"Marker",value:"UserTiming"},{key:"entryType",label:"Entry Type",format:"string"},{label:"Description",value:"UserTiming is created using the DOM APIs performance.mark() and performance.measure()."}]},{name:"Text",tableLabel:"{marker.name} — {marker.data.name}",chartLabel:"{marker.name} — {marker.data.name}",display:["marker-chart","marker-table"],data:[{key:"name",label:"Details",format:"string"}]},{name:"Log",display:["marker-table"],tableLabel:"({marker.data.module}) {marker.data.name}",data:[{key:"module",label:"Module",format:"string"},{key:"name",label:"Name",format:"string"}]},{name:"DOMEvent",tooltipLabel:"{marker.data.eventType} — DOMEvent",tableLabel:"{marker.data.eventType}",chartLabel:"{marker.data.eventType}",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"latency",label:"Latency",format:"duration"}]},{name:"Paint",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"Navigation",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"Layout",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"category",label:"Type",format:"string"}]},{name:"IPC",tooltipLabel:"IPC — {marker.data.niceDirection}",tableLabel:"{marker.name} — {marker.data.messageType} — {marker.data.niceDirection}",chartLabel:"{marker.data.messageType}",display:["marker-chart","marker-table","timeline-ipc"],data:[{key:"messageType",label:"Type",format:"string"},{key:"sync",label:"Sync",format:"string"},{key:"sendThreadName",label:"From",format:"string"},{key:"recvThreadName",label:"To",format:"string"}]},{name:"RefreshDriverTick",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"name",label:"Tick Reasons",format:"string"}]},{name:"Network",display:["marker-table"],data:[]}];for(const e of t.processes)e.meta.markerSchema=[]},23:e=>{!function t(r){if(e.meta.configuration&&e.meta.configuration.activeBrowsingContextID&&(e.meta.configuration.activeTabID=e.meta.configuration.activeBrowsingContextID,delete e.meta.configuration.activeBrowsingContextID),r.pages&&r.pages.length>0)for(const e of r.pages)e.tabID=e.browsingContextID,delete e.browsingContextID;for(const e of r.processes)t(e)}(e)},24:e=>{},25:e=>{},26:e=>{!function e(t){for(const e of t.meta.markerSchema){let t;switch(e.name){case"FileIO":e.data.push({key:"threadId",label:"Thread ID",format:"string",searchable:!0}),t=[];break;case"Log":t=["name","module"];break;case"DOMEvent":e.data.push({key:"eventType",label:"Event Type",format:"string",searchable:!0}),t=["target"];break;case"TraceEvent":t=["name1","name2","val1","val2"];break;default:t=["name","category"]}for(const r of e.data)t.includes(r.key)&&(r.searchable=!0)}for(const r of t.processes)e(r)}(e)},27:e=>{!function e(t){for(const e of t.threads)delete e.frameTable.schema.optimizations;for(const r of t.processes)e(r)}(e)},28:e=>{},29:e=>{!function e(t){if(t.counters&&t.counters.length>0)for(const e of t.counters)e.sample_groups&&(e.samples=e.sample_groups[0].samples,delete e.sample_groups);for(const r of t.processes)e(r)}(e)},30:e=>{},31:e=>{}},V=[{name:"User",color:"yellow",subcategories:["Other"]},{name:"Kernel",color:"orange",subcategories:["Other"]}];function q(e){const t=new Map;function r(e,r,n,a,s){let o=t.get(r);void 0===o&&(o=function(e,t,r){const n={schema:{name:0,startTime:1,endTime:2,phase:3,category:4,data:5},data:[]},a={schema:{stack:0,time:1,responsiveness:2},data:[]},s={schema:{location:0,relevantForJS:1,innerWindowID:2,implementation:3,optimizations:4,line:5,column:6,category:7,subcategory:8},data:[]},o={schema:{prefix:0,frame:1},data:[]},i=[],l=new Map,c=new Map;return{addSample:function(t,r,n){e!==t&&(e=t);const u=r.reduce(((e,t)=>function(e,t){const r=null===t?`${e}`:`${e},${t}`;let n=l.get(r);return void 0===n&&(n=o.data.length,o.data.push([t,e]),l.set(r,n)),n}(function(e){let t=c.get(e);if(void 0===t){t=s.data.length;const r=i.length;i.push(e);const n=e.includes("kallsyms")||e.includes("/vmlinux)")||e.endsWith(".ko)")?1:0,a=null,o=null,l=null,u=!1,m=null,d=0,h=null;s.data.push([r,u,d,a,o,l,h,n,m]),c.set(e,t)}return t}(t),e)),null);a.data.push([u,n,0])},finish:()=>({tid:r,pid:t,name:e,markers:n,samples:a,frameTable:s,stackTable:o,stringTable:i,registerTime:0,unregisterTime:null,processType:"default"})}}(n,e,r),t.set(r,o)),o.addSample(n,s,a)}const n=e.split("\n");let a=0,s=0;for(;a<n.length;){const e=n[a++];if(""===e||e.startsWith("#"))continue;const t=e,o=/^(.*)\s+([\d.]+):/.exec(t);if(!o){console.log('Could not parse line as the start of a sample in the "perf script" profile format: "%s"',t);continue}const i=o[1],l=1e3*parseFloat(o[2]),c=/^(.*)\s+(?:(\d+)\/)?(\d+)\b/.exec(i);if(!c){console.log('Could not parse line as the start of a sample in the "perf script" profile format: "%s"',t);continue}const u=c[1].trim(),m=Number(c[2]||0),d=Number(c[3]||0);0===s&&(s=l);const h=[];for(;a<n.length;){const e=n[a++];if(""===e.trim())break;const t=/^\s*(\w+)\s*(.+) \(([^)]*)\)/.exec(e);if(t){let e=t[2];const r=t[3];if(e=e.replace(/\+0x[\da-f]+$/,""),e.startsWith("("))continue;r&&(e+=` (in ${r})`),h.push(e)}}0!==h.length&&(h.reverse(),r(m,d,u,l,h))}const o=Array.from(t.values()).map((e=>e.finish()));for(const e of o){const t=e.samples.schema.time;e.samples.data.sort(((e,r)=>e[t]-r[t]))}return{meta:{interval:1,processType:0,product:"Firefox",stackwalk:1,debug:0,gcpoison:0,asyncstack:1,startTime:s,shutdownTime:null,version:24,presymbolicated:!0,categories:V,markerSchema:[]},libs:[],threads:o,processes:[],pausedRanges:[]}}const K=1464814675,H="\n".charCodeAt(0);class Q{constructor(e){this._decoder=void 0,this._u8View=void 0,this._dataView=void 0,this._pos=void 0,this._decoder=new TextDecoder("utf-8",{fatal:!0}),this._u8View=e,this._dataView=new DataView(this._u8View.buffer),this._pos=0}eof(){return this._pos>=this._u8View.length}curPos(){return this._pos}setCurPos(e){this._pos=e}getU8(){const e=this._dataView.getUint8(this._pos);return this._pos+=1,e}getU16(){const e=this._dataView.getUint16(this._pos,!0);return this._pos+=2,e}getU32(){const e=this._dataView.getUint32(this._pos,!0);return this._pos+=4,e}getU64(){const e=this.getU32();return this.getU32()*Math.pow(2,32)+e}getBytesUntil(e){if(e<this._pos)throw new Error(`getBytesUntil() called with a target position in the past (curPos: ${this._pos}, endPos: ${e})`);const t=this._u8View.subarray(this._pos,e);return this._pos=e,t}getBytes(e){return this.getBytesUntil(this._pos+e)}getString(e){const t=this.getBytes(e);return this._decoder.decode(t)}getLine(){let e=this._u8View.indexOf(H,this._pos);-1===e&&(e=this._u8View.length);const t=this._u8View.subarray(this._pos,e);return this._pos=e+1,this._decoder.decode(t)}}function Y(e){try{const t=11,r=e.slice(0,t),n=(new TextDecoder).decode(r);if(/\*version\n[1-3]\n/.test(n))return"regular"}catch(e){}try{if(new DataView(e).getUint32(0,!0)===K)return"streaming"}catch(e){}return"unrecognized"}function Z(e){if(e!==K){const t=`0x${K.toString(16)}`,r=`0x${e.toString(16)}`;throw new Error(`Unexpected magic header, expected ${t} (little endian), got ${r}`)}}function X(e){if(e<1||e>3)throw new Error(`This code only knows how to parse versions 1 to 3, got version ${e}.`)}function ee(e,t){if(e!==t)throw new Error(`Error: version number mismatch; got ${t} in summary but ${e} in data section`)}function te(e){let t=e.getLine();if("*version"!==t)throw new Error("Expected *version, got "+t);const r=+e.getLine();X(r);const n={summaryVersion:r,clock:"thread-cpu"};for(;t=e.getLine(),t&&!t.startsWith("*");){const[e,r]=t.split("=");n[e]=r}return{summaryVersion:r,summaryDetails:n,lineAfterSummary:t}}function re(e){const[t,r,n,a]=e.split("\t");return{methodId:+t,className:r,methodName:n,signature:a}}function ne(e,t){switch(t){case 1:return 9;case 2:return 10;default:return e.getU16()}}function ae(e,t,r,n){const a=e.curPos(),s=1===t?e.getU8():e.getU16(),o=e.getU32(),i=-4&o,l=3&o;if(l>2)throw new Error("Unexpected method action "+l);let c,u;switch(n){case"wall":c=e.getU32(),u=c;break;case"dual":u=e.getU32(),c=e.getU32();break;default:u=e.getU32(),c=u}return e.setCurPos(a+r),{tid:s,methodId:i,globalTime:c,threadTime:u,action:["enter","exit","exit-unroll"][l]}}function se(e){try{const t=new Q(new Uint8Array(e));switch(Y(e)){case"regular":return function(e){const{summaryVersion:t,summaryDetails:r,lineAfterSummary:n}=te(e);if("*threads"!==n)throw new Error("Expected *threads, got "+n);const{threads:a,lineAfterThreads:s}=function(e){const t=[];let r="";for(;r=e.getLine(),r&&!r.startsWith("*");){const[e,n]=r.split("\t");t.push({tid:+e,threadName:n})}return{threads:t,lineAfterThreads:r}}(e);if("*methods"!==s)throw new Error("Expected *methods, got "+s);const{methods:o,lineAfterMethods:i}=function(e){const t=[];let r="";for(;r=e.getLine(),r&&!r.startsWith("*");)t.push(re(r));return{methods:t,lineAfterMethods:r}}(e);if("*end"!==i)throw new Error("Expected *end, got "+i);const l=e.curPos();Z(e.getU32());const c=e.getU16();ee(c,t);const u=e.getU16(),m=e.getU64(),d=ne(e,c);e.setCurPos(l+u);const{clock:h}=r,f=[];for(;!e.eof();)f.push(ae(e,c,d,h));return{summaryDetails:r,threads:a,methods:o,methodActions:f,startTimeInUsecSinceBoot:m}}(t);case"streaming":return function(e){const t=e.curPos();Z(e.getU32());const r=240^e.getU16();X(r);const n=e.getU16(),a=e.getU64(),s=ne(e,r);e.setCurPos(t+n);const o=[],i=[],l=[];let c={clock:"thread-cpu"};for(;!e.eof();){const t=e.curPos();if(0!==e.getU16()){l.push(t),e.setCurPos(t+s);continue}const n=e.getU8();if(1===n){const t=e.getU16();o.push(re(e.getString(t)))}else{if(2!==n){if(3===n){const t=e.getU32(),n=e.getBytes(t),a=te(new Q(n));ee(r,a.summaryVersion),c=a.summaryDetails;break}throw new Error(`Invalid trace format: got invalid code ${n}.`)}{const t=e.getU16(),r=e.getU16(),n=e.getString(r);i.push({tid:t,threadName:n})}}}const{clock:u}=c,m=[];for(const t of l)e.setCurPos(t),m.push(ae(e,r,s,u));return{summaryDetails:c,threads:i,methods:o,methodActions:m,startTimeInUsecSinceBoot:a}}(t);default:throw new Error("Not an ART trace")}}catch(e){throw console.error("Source exception:",e),new Error(`Could not parse the profile array buffer as an ART trace: ${e}`)}}class oe{constructor(e){this.idleCategory=0,this.otherCategory=1,this.blockingCategory=2,this.androidCategory=3,this.javaCategory=4,this.kotlinCategory=5,this.androidxCategory=6,this.specialCategory=7,this.categories=[{name:"Idle",color:"transparent"},{name:"Other",color:"grey"},{name:"Blocked",color:"lightblue"},{name:"Android",color:"yellow"},{name:"Java",color:"blue"},{name:"Kotlin / KotlinX",color:"purple"},{name:"AndroidX",color:"orange"},{name:"Special",color:"green"}],this._specialCategoryInfo=void 0,this._specialCategoryInfo=function(e){function t(e){const t=e.startsWith("org.")||e.startsWith("com.")?e.substring(4):e,r=t.indexOf(".");return-1===r?t:t.substring(0,r)}const r=new Map;for(let n=0;n<e.length;n++){const a=t(e[n].className);switch(a){case"android":case"java":case"sun":case"kotlin":case"androidx":case"kotlinx":break;default:{const e=r.get(a)||0;r.set(a,e+1)}}}const n=Array.from(r.entries());if(0===n.length)return;n.sort((([e,t],[r,n])=>n-t));const[a]=n[0];return{prefixes:[`${a}.`,`com.${a}.`,`org.${a}.`],name:a[0].toUpperCase()+a.slice(1)}}(e),this._specialCategoryInfo&&(this.categories[this.specialCategory].name=this._specialCategoryInfo.name)}inferJavaCategory(e){return"android.os.MessageQueue.nativePollOnce"===e?this.idleCategory:"java.lang.Object.wait"===e?this.blockingCategory:e.startsWith("android.")||e.startsWith("com.android.")?this.androidCategory:e.startsWith("java.")||e.startsWith("sun.")||e.startsWith("com.sun.")?this.javaCategory:e.startsWith("kotlin.")||e.startsWith("kotlinx.")?this.kotlinCategory:e.startsWith("androidx.")?this.androidxCategory:this._specialCategoryInfo&&this._specialCategoryInfo.prefixes.some((t=>e.startsWith(t)))?this.specialCategory:this.otherCategory}}class ie{constructor(e,t,r,n,a,s,o){this._markers={schema:{name:0,time:1,data:2},data:[]},this._samples={schema:{stack:0,time:1,responsiveness:2,rss:3,uss:4},data:[]},this._frameTable={schema:{location:0,implementation:1,optimizations:2,line:3,category:4},data:[]},this._stackTable={schema:{frame:0,prefix:1},data:[]},this._stringTable=[],this._currentStack=null,this._nextSampleTimestamp=0,this._stackMap=new Map,this._frameMap=new Map,this._registerTime=0,this._name=void 0,this._pid=void 0,this._tid=void 0,this._methodMap=void 0,this._intervalInMsec=void 0,this._honorOriginalSamplingTimestamps=void 0,this._categoryInfo=void 0,this._name=e,this._pid=t,this._tid=r,this._methodMap=n,this._intervalInMsec=a,this._honorOriginalSamplingTimestamps=s,this._categoryInfo=o}_getOrCreateStack(e,t){const r=null===t?`${e}`:`${e},${t}`;let n=this._stackMap.get(r);return void 0===n&&(n=this._stackTable.data.length,this._stackTable.data.push([e,t]),this._stackMap.set(r,n)),n}_getOrCreateFrameForMethodId(e){let t=this._frameMap.get(e);if(void 0===t){const r=this._methodMap.get(e);let n;if(void 0===r)n="<unknown method ID 0x"+e.toString(16)+">";else{const{className:e,methodName:t}=r;n=e+"."+t}const a=this._stringTable.length;this._stringTable.push(n);const s=this._categoryInfo.inferJavaCategory(n);t=this._frameTable.data.length,this._frameTable.data.push([a,null,null,null,s]),this._frameMap.set(e,t)}return t}enterMethod(e){const t=this._getOrCreateFrameForMethodId(e);this._currentStack=this._getOrCreateStack(t,this._currentStack)}exitMethod(e){null!==this._currentStack&&(this._currentStack=this._stackTable.data[this._currentStack][1])}advanceTimeTo(e){if(0===this._nextSampleTimestamp)return this._nextSampleTimestamp=e,void("main"!==this._name&&(this._registerTime=e));for(;this._nextSampleTimestamp<e;){if(this._samples.data.push([this._currentStack,this._nextSampleTimestamp]),this._honorOriginalSamplingTimestamps&&e-this._nextSampleTimestamp<2*this._intervalInMsec){this._nextSampleTimestamp=e;break}this._nextSampleTimestamp+=this._intervalInMsec}}finish(){return null!==this._nextSampleTimestamp&&this._samples.data.push([this._currentStack,this._nextSampleTimestamp]),{tid:this._tid,pid:this._pid,name:this._name,registerTime:this._registerTime,unregisterTime:null,markers:this._markers,samples:this._samples,frameTable:this._frameTable,stackTable:this._stackTable,stringTable:this._stringTable}}}function le(e,t,r){const n=function(e){if(0===e.length)return{events:[],start:[],end:[],line:[],column:[],length:0};let t=e.timestamps[0],r=t+e.durations[0];const n=[t],a=[r],s={events:e.events,start:n,end:a,line:e.line,column:e.column,length:e.length};for(let s=1;s<e.length;s++){const o=e.durations[s];let i=e.timestamps[s],l=i+(null===o?0:o);if(i<t)if(t<l)i=t;else{const e=l-i;i=t,l=Math.min(r,i+e)}else l<r||r<=i||(r-i<l-r?i=r:l=r);n.push(i),a.push(l),t=i,r=l}return s}(t),a=o.M.withBackingArray(e.stringArray),{thread:l,stackMap:c}=function(e,t,r,n){const a=(0,s.vA)(),o=(0,s.Gh)(),i={...(0,s.cy)(),weight:[],weightType:"tracing-ms"},l=(0,s.qc)(),c={...e.funcTable},u={...e,markers:l,funcTable:c,stackTable:o,frameTable:a,samples:i};let m=0;const d=[null],h=[0],f=new Map,p=new Map,g=new Map,y=t.indexForString(""),b=n.findIndex((e=>"Other"===e.name));if(-1===b)throw new Error("Expected to find an 'Other' category.");const w=function(e,t){const{funcTable:r}=e,n=new Map;for(let e=0;e<r.length;e++){if(!r.isJS[e])continue;const a=r.lineNumber[e],s=r.columnNumber[e],o=r.fileName[e];if(null!==s&&null!==a&&null!==o){const r=`${t.getString(o)}:${a}:${s}`;n.has(r)?n.set(r,null):n.set(r,e)}}return n}(u,t),k={Interpreter:t.indexForString("interpreter"),Baseline:t.indexForString("baseline"),IonMonkey:t.indexForString("ion")},v=new Set(Object.keys(k));for(let e=0;e<r.length;e++){const n=r.events[e],s=t.getString(n),i=r.end[e],l=r.column[e],u=r.line[e];let T=null;if(null!==l&&null!==u){const e=`${s}:${u}:${l}`,t=w.get(e);null!=t&&(T=t,f.set(n,T))}if(null===T){const e=f.get(n);void 0===e?(T=c.length++,c.name.push(n),c.isJS.push(!1),c.resource.push(-1),c.relevantForJS.push(!0),c.fileName.push(null),c.lineNumber.push(null),c.columnNumber.push(null),f.set(n,T)):T=e}let S=d[m];for(;null!==S&&!(i<=h[m]);)S=d[m],m--;let x=null;if(v.has(s))x=k[s];else if(null!==S){const e=g.get(S);if(void 0===e)throw new Error(`Expected to find an implementation from a js tracer prefix index prefixIndex: ${S}`);x=e}g.set(e,x);const _=a.length++;a.address.push(y),a.inlineDepth.push(0),a.category.push(b),a.func.push(T),a.nativeSymbol.push(null),a.innerWindowID.push(0),a.implementation.push(x),a.line.push(u),a.column.push(l);const I=o.length++;o.frame.push(_),o.prefix.push(S),p.set(e,I),m++,0===m&&(m=1),d[m]=e,h[m]=i}return{thread:u,stackMap:p}}(e,a,n,r);return l.samples=function(e,t,r){const n=1e-5,a=(e,t)=>Math.abs(e-t)<n,o=(0,s.cy)(),l=[];function c(e,t,n){if(a(t,n))return;const s=(0,i.Nn)(r.get(e),"The JS tracer event did not exist in the stack map.");o.stack.push(s),(0,i.Nn)(o.time).push(t/1e3),l.push((n-t)/1e3),o.length++}o.weight=l;const u=[],m=[],d=[];let h=-1;for(let r=0;r<t.length;r++){const s=t.start[r],o=t.end[r];if(-1!==h)for(;;){const i=u[h],l=m[h],f=d[h];if(!(l<=s+n)){if(o<l+n){c(f,i,s),u[h]=o,h++,u[h]=s,m[h]=o,d[h]=r;break}if(a(l,o)){a(i,s)||(c(f,i,s),u[h]=s),d[h]=r;break}{const n=e.getString(t.events[f]),a=e.getString(t.events[r]);throw console.error("Current JS Tracer information:",{jsTracer:t,stringTable:e,prefixEventIndex:f,currentEventIndex:r}),console.error(`Prefix (parent) times for "${n}": ${i}ms to ${l}ms`),console.error(`Current (child) times for "${a}": ${s}ms to ${o}ms`),new Error("The JS Tracer information was malformed. Some event lasted longer than its parent event.")}}if(c(f,i,l),h--,-1===h){h=0,d[h]=r,u[h]=s,m[h]=o;break}}else h=0,u[h]=s,m[h]=o,d[h]=r}for(;h>=0;h--)c(d[h],u[h],m[h]);return o}(a,n,c),l}const ce=class{constructor(e){return new window.Worker(`/${e}.js`)}},ue=[];function me(e){const t={length:e.data.length};for(const r in e.schema){const n=e.schema[r];if("number"!=typeof n)throw new Error("fieldIndex must be a number in the Gecko profile table.");t[r]=e.data.map((e=>n in e?e[n]:null))}return t}class de{constructor(){this._libs=[],this._libKeyToLibIndex=new Map}indexForLib(e){const{debugName:t,breakpadId:r}=e,n=`${t}/${r}`;let a=this._libKeyToLibIndex.get(n);if(void 0===a){a=this._libs.length;const{arch:s,name:o,path:i,debugPath:l,codeId:c}=e;this._libs.push({arch:s,name:o,path:i,debugName:t,debugPath:l,breakpadId:r,codeId:c??null}),this._libKeyToLibIndex.set(n,a)}return a}finish(){return{libs:this._libs}}}function he(e,t,r){if(!t.startsWith("0x"))return null;const{addressLocator:n,libToResourceIndex:a,resourceTable:o,funcTable:i,stringTable:l}=e;let c=-1,u=-1;try{const r=t,{lib:i,relativeAddress:m}=n.locateAddress(r);if(null!==i){u=m;const t=e.globalDataCollector.indexForLib(i);c=a.get(t),void 0===c&&(c=o.length++,o.lib[c]=t,o.name[c]=l.indexForString(i.name),o.host[c]=null,o.type[c]=s.AU.library,a.set(t,c))}}catch(e){}const m=i.length++;return i.name[m]=r,i.resource[m]=c,i.relevantForJS[m]=!1,i.isJS[m]=!1,i.fileName[m]=null,i.lineNumber[m]=null,i.columnNumber[m]=null,{funcIndex:m,frameAddress:u}}function fe(e,t){const r=/^(.*) \(in ([^)]*)\) (\+ [0-9]+)$/.exec(t)||/^(.*) \(in ([^)]*)\) (\(.*:.*\))$/.exec(t)||/^(.*) \(in ([^)]*)\)$/.exec(t);if(!r)return null;const{funcTable:n,stringTable:a,stringToNewFuncIndexAndFrameAddress:o,libNameToResourceIndex:i,resourceTable:l}=e,[,c,u]=r,m=(p=c).startsWith&&p.startsWith("non-virtual thunk to ")?p.substr(21):p,d=a.indexForString(m),h=a.indexForString(u),f=o.get(m);var p;if(void 0!==f)return f.funcIndex;let g=i.get(h);void 0===g&&(g=l.length++,i.set(h,g),l.lib[g]=null,l.name[g]=h,l.host[g]=null,l.type[g]=s.AU.library);const y=n.length++;return n.name[y]=d,n.resource[y]=g,n.relevantForJS[y]=!1,n.isJS[y]=!1,n.fileName[y]=null,n.lineNumber[y]=null,n.columnNumber[y]=null,y}function pe(e,t,r){const{originToResourceIndex:n,resourceTable:a,stringTable:o}=e,i=new URL(t.baseURL[r]).origin;let l=n.get(i);if(void 0===l){l=a.length++,n.set(i,l);const e=`Extension ${JSON.stringify(t.name[r])} (ID: ${t.id[r]})`,c=o.indexForString(t.id[r]);a.lib[l]=null,a.name[l]=o.indexForString(e),a.host[l]=c,a.type[l]=s.AU.addon}}function ge(e,t){const r=/^(.*) \((.+?):([0-9]+)(?::([0-9]+))?\)$/.exec(t)||/^()(.+?):([0-9]+)(?::([0-9]+))?$/.exec(t);if(!r)return null;const{funcTable:n,stringTable:a,resourceTable:s,originToResourceIndex:o}=e,[,i,l]=r,c=function(e){if(e){const t=e.split(" -> ");return t[t.length-1]}return e}(l),u=E(c,s,a,o);let m;m=i?a.indexForString(i):a.indexForString(`(root scope) ${c}`);const d=a.indexForString(c),h=parseInt(r[3],10),f=r[4]?parseInt(r[4],10):null,p=n.length++;return n.name[p]=m,n.resource[p]=u,n.relevantForJS[p]=!1,n.isJS[p]=!0,n.fileName[p]=d,n.lineNumber[p]=h,n.columnNumber[p]=f,p}function ye({funcTable:e},t,r){const n=e.length++;return e.name[n]=t,e.resource[n]=-1,e.relevantForJS[n]=r,e.isJS[n]=!1,e.fileName[n]=null,e.lineNumber[n]=null,e.columnNumber[n]=null,n}function be(e){if(!e)return null;if(e.stack&&e.stack.samples.data.length>0){const{samples:t}=e.stack;return t.data[0][t.schema.stack]}return null}function we(e){const t={};for(const r in e)t[r]=1e3*e[r];return t}function ke(e){if(!e)return null;const t=function(e){if("stack"in e&&e.stack&&e.stack.samples.data.length>0){const{stack:t,...r}=e,n=t.samples.data[0][t.samples.schema.stack],a=t.samples.data[0][t.samples.schema.time];return null!==n?{...r,cause:{tid:t.tid,time:a,stack:n}}:r}return e}(e);switch(t.type){case"GCSlice":{const{times:e,...r}=t.timings;return{type:"GCSlice",timings:{...r,phase_times:e?we(e):{}}}}case"GCMajor":{const e=t.timings;switch(e.status){case"completed":{const{totals:t,...r}=e;return{type:"GCMajor",timings:{...r,phase_times:we(t),mmu_20ms:e.mmu_20ms/100,mmu_50ms:e.mmu_50ms/100}}}case"aborted":return{type:"GCMajor",timings:{status:"aborted"}};default:throw console.log("Unknown GCMajor status"),new Error("Unknown GCMajor status")}}case"IPC":{const{startTime:e,endTime:r,otherPid:n,messageType:a,messageSeqno:s,side:o,direction:i,phase:l,sync:c,threadId:u}=t;return{type:"IPC",startTime:e,endTime:r,otherPid:`${n}`,messageType:a,messageSeqno:s,side:o,direction:i,phase:l,sync:c,threadId:u}}default:return t}}function ve(e){const t=1e6,r=new Array(e.length);let n=0;for(let a=0;a<e.length;a++){const s=Math.round(e[a]*t);r[a]=(s-n)/t,n=s}return r}function Te(e,t,r){const n=e.counters,a=e.threads.find((e=>"GeckoMain"===e.name));if(!a||!n)return[];const s=`${a.pid}`,o=t.findIndex((e=>"GeckoMain"===e.name&&e.pid===s));if(-1===o)throw new Error("Unable to find the main thread in the stable thread list. This means that the logic in the _processCounters function is wrong.");return n.reduce(((e,{name:t,category:n,description:a,samples:i})=>{if(0===i.data.length)return e;const l={timeDeltas:ve((c=me(i)).time),number:c.number,count:c.count,length:c.length};var c;return e.push({name:t,category:n,description:a,pid:s,mainThreadIndex:o,samples:Ie(l,r)}),e}),[])}function Se(e,t,r){const n=e.profilerOverhead,a=e.threads.find((e=>"GeckoMain"===e.name));if(!a||!n)return null;const s=`${a.pid}`,o=t.findIndex((e=>"GeckoMain"===e.name&&e.pid===s));if(-1===o)throw new Error("Unable to find the main thread in the stable thread list. This means that the logic in the _processProfilerOverhead function is wrong.");return{samples:Ce(me(n.samples),r),pid:s,mainThreadIndex:o,statistics:n.statistics}}function xe(e,t,r,n){const a=me(e.frameTable),l=me(e.stackTable),c=me(e.samples),u=me(function(e){const{startTime:t,endTime:r}=e.schema,n=e.data.slice(0);return n.sort(((e,n)=>{const a=e[r]||e[t],s=n[r]||n[t];if(null===a)throw console.error(e),new Error("A marker had null start and end time.");if(null===s)throw console.error(n),new Error("A marker had null start and end time.");return a-s})),Object.assign({},e,{data:n})}(e.markers)),{libs:m,pausedRanges:d,meta:h}=t,{shutdownTime:f}=h,p=e.stringTable.slice(),g=o.M.withBackingArray(p),{funcTable:y,resourceTable:b,frameFuncs:w,frameAddresses:k}=function(e,t,r,n,a=(0,s.Ie)(),o){const i={funcTable:(0,s.uv)(),resourceTable:(0,s.WU)(),stringTable:r,addressLocator:new $(n),libToResourceIndex:new Map,originToResourceIndex:new Map,libNameToResourceIndex:new Map,stringToNewFuncIndexAndFrameAddress:new Map,globalDataCollector:o};for(let e=0;e<a.length;e++)pe(i,a,e);const l=[],c=[];for(let n=0;n<e.length;n++){const a=e[n],s=r.getString(a),o=t[n],u=i.stringToNewFuncIndexAndFrameAddress.get(s);if(void 0!==u){const{funcIndex:e,frameAddress:t}=u;l.push(e),c.push(t);continue}let m=null,d=null;const h=he(i,s,a);null!==h?(m=h.funcIndex,d=h.frameAddress):(m=fe(i,s),null===m&&(m=ge(i,s),null===m&&(m=ye(i,a,o)))),i.stringToNewFuncIndexAndFrameAddress.set(s,{funcIndex:m,frameAddress:d}),l.push(m),c.push(d)}return{funcTable:i.funcTable,resourceTable:i.resourceTable,frameFuncs:l,frameAddresses:c}}(a.location,a.relevantForJS,g,m,r,n),v=(0,s.Ry)(),T=function(e,t,r){return{address:r.map((e=>e??-1)),inlineDepth:Array(e.length).fill(0),category:e.category,subcategory:e.subcategory,func:t,nativeSymbol:Array(e.length).fill(null),innerWindowID:e.innerWindowID,implementation:e.implementation,line:e.line,column:e.column,length:e.length}}(a,w,k),S=function(e){return{frame:e.frame,prefix:e.prefix,length:e.length}}(l),{markers:x,jsAllocations:_,nativeAllocations:I}=function(e){const t=(0,s.qc)(),r=(0,s.uz)(),n=(0,s.x2)(),a=[],o=[];let l,c;for(let s=0;s<e.length;s++){const c=e.data[s];if(c)switch(c.type){case"JS allocation":r.time.push((0,i.Nn)(e.startTime[s],"JS Allocations are assumed to have a startTime")),r.className.push(c.className),r.typeName.push(c.typeName),r.coarseType.push(c.coarseType),r.weight.push(c.size),r.inNursery.push(c.inNursery),r.stack.push(be(c)),r.length++;continue;case"Native allocation":void 0===l&&(l="memoryAddress"in c),n.time.push((0,i.Nn)(e.startTime[s],"Native Allocations are assumed to have a startTime")),n.weight.push(c.size),n.stack.push(be(c)),n.length++,l&&(a.push((0,i.Nn)(c.memoryAddress,"Could not find the memoryAddress property on a gecko marker payload.")),o.push((0,i.Nn)(c.threadId,"Could not find a threadId property on a gecko marker payload.")));continue}const u=ke(c),m=e.name[s],d=e.startTime[s],h=e.endTime[s],f=e.phase[s],p=e.category[s];t.name.push(m),t.startTime.push(d),t.endTime.push(h),t.phase.push(f),t.category.push(p),t.data.push(u),t.length++}return c=0===n.length?null:l?{time:n.time,weight:n.weight,weightType:n.weightType,stack:n.stack,memoryAddress:a,threadId:o,length:n.length}:{time:n.time,weight:n.weight,weightType:n.weightType,stack:n.stack,length:n.length},{markers:t,jsAllocations:0===r.length?null:r,nativeAllocations:c}}(u),N=function(e){const t={stack:e.stack,timeDeltas:ve(e.time),weightType:"samples",weight:null,length:e.length};if(e.threadCPUDelta&&e.threadCPUDelta.some((e=>null!==e))&&(t.threadCPUDelta=e.threadCPUDelta),e.eventDelay)t.eventDelay=e.eventDelay;else{if(!e.responsiveness)throw new Error("The profile processor expected an eventDelay or responsiveness array in the samples table, but none was found.");t.responsiveness=e.responsiveness}return t}(c),E={name:e.name,isMainThread:"GeckoMain"===e.name,"eTLD+1":e["eTLD+1"],processType:e.processType,processName:"string"==typeof e.processName?e.processName:"",processStartupTime:0,processShutdownTime:f,registerTime:e.registerTime,unregisterTime:e.unregisterTime,tid:e.tid,pid:`${e.pid}`,pausedRanges:d||[],frameTable:T,funcTable:y,nativeSymbols:v,resourceTable:b,stackTable:S,markers:x,stringArray:p,samples:N};return void 0!==e.isPrivateBrowsing&&(E.isPrivateBrowsing=e.isPrivateBrowsing),void 0!==e.userContextId&&(E.userContextId=e.userContextId),_&&(E.jsAllocations=_),I&&(E.nativeAllocations=I),function(){const{jsTracerEvents:r}=e,{jsTracerDictionary:n}=t;if(r&&n){const e=new Array(n.length);for(let t=0;t<n.length;t++)e[t]=g.indexForString(n[t]);const t=r.events.slice();for(let r=0;r<t.length;r++){const n=t[r];t[r]=e[n]}E.jsTracer={...r,events:t}}}(),function(e){const{samplingSelfStacks:t,syncBacktraceSelfStacks:r}=function(e){const t=new Set,r=new Set,{samples:n,markers:a,jsAllocations:s,nativeAllocations:o}=e;for(let e=0;e<n.length;e++){const r=n.stack[e];null!==r&&t.add(r)}for(let e=0;e<a.length;e++){const t=a.data[e];if(t&&t.cause){const e=t.cause.stack;null!==e&&r.add(e)}}if(void 0!==s)for(let e=0;e<s.length;e++){const t=s.stack[e];null!==t&&r.add(t)}if(void 0!==o)for(let e=0;e<o.length;e++){const t=o.stack[e];null!==t&&r.add(t)}return{samplingSelfStacks:t,syncBacktraceSelfStacks:r}}(e),{stackTable:n,frameTable:a}=e,o=new Uint32Array(a.length),i=new Set;for(const e of t){const t=n.frame[e];o[t]=t,-1!==a.address[t]&&i.add(t)}const l=new Map,c=new Set;for(const e of r){const t=n.frame[e],r=a.address[t];-1!==r&&l.set(t,r)}for(let e=0;e<n.length;e++){const t=n.prefix[e];if(null===t||c.has(t))continue;c.add(t);const r=n.frame[t],s=a.address[r];-1!==s&&l.set(r,s)}if(0===i.size&&0===l.size)return e;const u=(0,s.LK)(a);for(const[e,t]of l){if(i.has(e)){const r=u.length;u.address.push(t),u.inlineDepth.push(a.inlineDepth[e]),u.category.push(a.category[e]),u.subcategory.push(a.subcategory[e]),u.func.push(a.func[e]),u.nativeSymbol.push(a.nativeSymbol[e]),u.innerWindowID.push(a.innerWindowID[e]),u.implementation.push(a.implementation[e]),u.line.push(a.line[e]),u.column.push(a.column[e]),u.length++,o[e]=r}u.address[e]=t-1}const m=(0,s.Gh)(),d=new Map,h=new Map,f=new Uint32Array(n.length);for(let e=0;e<n.length;e++){const a=n.frame[e],s=n.prefix[e],i=null===s?null:f[s];if(c.has(e)||r.has(e)){const t=m.length;m.frame.push(a),m.prefix.push(i),m.length++,f[e]=t,h.set(e,t)}if(t.has(e)){const t=o[a],r=m.length;m.frame.push(t),m.prefix.push(i),m.length++,d.set(e,r)}}return M({...e,frameTable:u},m,C(d),C(h))}(E)}function _e(e,t){return{...e,time:e.time.map((e=>e+t))}}function Ie(e,t){const{timeDeltas:r}=e;if(void 0===r)throw new Error("Should only be called when a timeDeltas column is present");const n=r.slice();return n[0]+=t,{...e,timeDeltas:n}}function Me(e,t){const r=1e3*t;return{...e,timestamps:e.timestamps.map((e=>e+r))}}function Ce(e,t){return{...e,time:e.time.map((e=>e/1e3+t))}}function Ne(e,t){function r(e){return null===e?e:e+t}return{...e,startTime:e.startTime.map(r),endTime:e.endTime.map(r),data:e.data.map((e=>{if(!e)return e;const r=(0,i.Cn)(e);return"number"==typeof r.startTime&&(r.startTime+=t),"number"==typeof r.endTime&&(r.endTime+=t),r.cause&&void 0!==r.cause.time&&(r.cause.time+=t),"Network"===r.type&&("number"==typeof r.domainLookupStart&&(r.domainLookupStart+=t),"number"==typeof r.domainLookupEnd&&(r.domainLookupEnd+=t),"number"==typeof r.connectStart&&(r.connectStart+=t),"number"==typeof r.tcpConnectEnd&&(r.tcpConnectEnd+=t),"number"==typeof r.secureConnectionStart&&(r.secureConnectionStart+=t),"number"==typeof r.connectEnd&&(r.connectEnd+=t),"number"==typeof r.requestStart&&(r.requestStart+=t),"number"==typeof r.responseStart&&(r.responseStart+=t),"number"==typeof r.responseEnd&&(r.responseEnd+=t)),r}))}}function Ee(e){const t=e.meta.markerSchema,r=new Set(e.meta.markerSchema.map((({name:e})=>e)));for(const n of e.processes)for(const e of n.meta.markerSchema)r.has(e.name)||(r.add(e.name),t.push(e));return t}async function Ae(e,t){try{if("[object ArrayBuffer]"===String(e)){let t=e;const a=new Uint8Array(t);if((n=a).byteLength>=3&&31===n[0]&&139===n[1]&&8===n[2]){const e=await function(e){return new Promise((function(t,r){const n=new ce("zee-worker");(function(e){e.onmessage=function(e){const t=e.data,r=ue[t.callbackID];r&&(r[t.type](t.data),ue[t.callbackID]=null)}})(n),n.postMessage({request:"decompress",data:e,callbackID:ue.length},[e.buffer]),ue.push({success:t,error:r})}))}(a);t=e.buffer}if("unrecognized"!==Y(t))e=function(e){const t=se(e),r=function(e){const{methodActions:t}=e,r=[],n=new Map,a=Math.min(500,t.length);for(let e=0;e<a;e++){const{tid:a,globalTime:s}=t[e],o=n.get(a);if(s!==o){if(void 0!==o){const e=s-o;r.push(e)}n.set(a,s)}}if(r.sort(((e,t)=>e-t)),r.length<5)return r[0];const s=r.slice(0,Math.floor(r.length/5));return s.reduce(((e,t)=>e+t),0)/s.length}(t);let n,a=!1;!r||r<100?n=.1:(n=Math.round(r/100)/10,a=!0);const{summaryDetails:s,threads:o,methods:i,methodActions:l}=t,c=new oe(i),u=new Map(i.map((e=>[e.methodId,e]))),m=new Map;if(l.length>0)for(let e=0;e<l.length;e++){const{tid:t,methodId:r,globalTime:i,action:d}=l[e];let h=m.get(t);if(void 0===h){const e=o.find((e=>e.tid===t));if(!e)throw new Error(`Encountered method action for unknown thread ${t}`);h=new ie(e.threadName,s.pid?+s.pid:1,t,u,n,a,c),m.set(t,h)}switch(h.advanceTimeTo(i/1e3),d){case"enter":h.enterMethod(r);break;case"exit":case"exit-unroll":h.exitMethod(r);break;default:throw new Error(`Unexpected action ${d}`)}}const d=Array.from(m.values()).map((e=>e.finish()));return{meta:{interval:n,processType:0,product:"ART Trace (Android)",importedFrom:"ART Trace (Android)",pid:s.pid,stackwalk:1,startTime:0,shutdownTime:null,version:11,presymbolicated:!0,categories:c.categories},libs:[],threads:d,processes:[],pausedRanges:[]}}(t);else if((0,j.x)(j.S,t)){const{convertSimpleperfTraceProfile:n}=await Promise.all([r.e(957),r.e(999)]).then(r.bind(r,999));e=n(t)}else try{const r=new TextDecoder("utf-8",{fatal:!0});e=await r.decode(t)}catch(e){throw console.error("Source exception:",e),new Error("The profile array buffer could not be parsed as a UTF-8 string.")}}"string"==typeof e&&(e=function(e){if(e.startsWith("# ========\n"))return!0;if(e.startsWith("{"))return!1;const t=e.substring(0,e.indexOf("\n"));return/^\S.*?\s+(?:\d+\/)?\d+\s+(?:\[\d+\]\s+)?[\d.]+:/.test(t)}(e)?q(e):JSON.parse(e));const a=e,c=function(e){if(!e||"object"!=typeof e)return null;const{meta:t}=e;if(!t||"object"!=typeof t)return null;if("number"!=typeof t.preprocessedProfileVersion){const{threads:t}=e;if(!t||!Array.isArray(t))return null;const[r]=t;if(!r||"object"!=typeof r||!r.stringArray)return null}const r="number"==typeof t.preprocessedProfileVersion?t.preprocessedProfileVersion:0;if(r===l.Ie)return(0,i.au)(e);if(r>l.Ie)throw new Error(`Unable to parse a processed profile of version ${r}, most likely profiler.firefox.com needs to be refreshed. The most recent version understood by this version of profiler.firefox.com is version ${l.Ie}.\nYou can try refreshing this page in case profiler.firefox.com has updated in the meantime.`);for(let t=r+1;t<=l.Ie;t++)t in J&&J[t](e);const n=(0,i.au)(e);return n.meta.preprocessedProfileVersion=l.Ie,n}(function(e){if(!e||"object"!=typeof e)return e;const{meta:t}=e;if(!t||"object"!=typeof t)return e;if("number"!=typeof t.preprocessedProfileVersion)return e;const{threads:r}=e;if(!r||!Array.isArray(r)||!r.length)return e;const[n]=r;if(n.stringArray)return e;if(!n.stringTable)return e;for(const t of e.threads)t.stringArray=t.stringTable._array,delete t.stringTable;return e}(a));if(c)return c;const u=function(e,t){if(!e)return null;let r;if(Array.isArray(e)){const t=e[0];t&&"object"==typeof t&&"ph"in t&&"cat"in t&&"args"in t&&(r=(0,i.au)(e))}else"object"==typeof e&&"samples"in e&&"timeDeltas"in e&&"startTime"in e&&"endTime"in e?(r=[],r.push({name:"CpuProfile",args:{data:{cpuProfile:(0,i.au)(e)}},cat:"other",pid:0,tid:0,ts:0,ph:"I"})):"object"==typeof e&&"traceEvents"in e&&Array.isArray(e.traceEvents)&&(r=(0,i.au)(e.traceEvents));if(!r)return null;const n=new Map;for(const e of r){if("object"!=typeof e||null===e||"string"!=typeof e.name)throw new Error("A tracing event in the chrome profile did not follow the expected form.");const{name:t}=e;let r=n.get(t);r||(r=[],n.set(t,r)),r.push(e)}return async function(e,t){const r=(0,s.Z)();r.meta.categories=[{name:"Other",color:"grey",subcategories:["Other"]},{name:"Idle",color:"transparent",subcategories:["Other"]},{name:"JavaScript",color:"yellow",subcategories:["Other"]},{name:"GC / CC",color:"orange",subcategories:["Other"]},{name:"Graphics",color:"green",subcategories:["Other"]},{name:"Native",color:"blue",subcategories:["Other"]}],r.meta.product="Chrome Trace",r.meta.importedFrom="Chrome Trace",r.meta.interval=.5;let n=e.get("Profile")||[];if(e.has("CpuProfile")){const t=e.get("CpuProfile");n=n.concat(t)}const a=function(e){const t=e.findIndex((e=>"JavaScript"===e.name)),r=e.findIndex((e=>"GC / CC"===e.name)),n=e.findIndex((e=>"Native"===e.name)),a=e.findIndex((e=>"Other"===e.name)),s=e.findIndex((e=>"Idle"===e.name));if(-1===t||-1===r||-1===n||-1===a||-1===s)throw new Error("Unable to find the a category in the the defaultCategories.");return function(e,o){switch(e){case"(idle)":return{category:s,isJS:!1,relevantForJS:!1};case"(root)":case"(program)":return{category:a,isJS:!1,relevantForJS:!1};case"(garbage collector)":return{category:r,isJS:!1,relevantForJS:!1};default:return o||"<WASM UNNAMED>"===e||"(unresolved function)"===e?{category:t,isJS:!0,relevantForJS:!1}:{category:n,isJS:!1,relevantForJS:!0}}}}((0,i.Nn)(r.meta.categories)),c=new Map,u=new Map;for(const t of n){const n=O(c,u,e,r,t),{thread:s,funcKeyToFuncId:l,nodeIdToStackId:m,originToResourceIndex:d}=n;let h=[];if("Profile"===t.name){n.lastSeenTime=t.args.data.startTime/1e3;const{id:r,pid:a}=t;h=D(e,"ProfileChunk",(e=>e.id===r&&e.pid===a))}else"CpuProfile"===t.name&&(n.lastSeenTime=r.meta.profilingStartTime=t.args.data.cpuProfile.startTime/1e3,r.meta.profilingEndTime=t.args.data.cpuProfile.endTime/1e3,h=[t]);for(const e of h){if(!e.args.data||!e.args.data.cpuProfile)continue;const{cpuProfile:t}=e.args.data,{nodes:c,samples:u}=t,h=P(e);if(!h)continue;const{funcTable:f,frameTable:p,stackTable:g,stringArray:y,samples:b,resourceTable:w}=s,k=o.M.withBackingArray(y);if(c){const e=new Map;for(const t of c){const{callFrame:r,id:n}=t;let s;if(s=void 0!==t.parent?t.parent:e.get(n),void 0!==t.children){const r=t.children;for(let t=0;t<r.length;t++)e.set(r[t],n)}let{url:o,lineNumber:i,columnNumber:c}=r;-1===i&&(i=void 0),-1===c&&(c=void 0),void 0!==i&&i++,void 0!==c&&c++,""===o&&(o=void 0);const{functionName:u}=r,h=`${u}:${o||""}:${i||0}:${c||0}`,{category:y,isJS:b,relevantForJS:v}=a(u,void 0!==o||void 0!==i);let T=l.get(h);if(void 0===T){T=f.length++,f.isJS.push(b),f.relevantForJS.push(v);const e=""!==u?u:"(anonymous)";f.name.push(k.indexForString(e)),f.resource.push(b?E(o||"<unknown>",w,k,d):-1),f.fileName.push(b?k.indexForString(o||"<unknown>"):null),f.lineNumber.push(void 0===i?null:i),f.columnNumber.push(void 0===c?null:c),l.set(h,T)}const S=n-1,x=m.get(s);if(void 0===x)throw new Error("Unable to find the prefix stack index from a node index.");p.address[S]=-1,p.category[S]=y,p.subcategory[S]=0,p.func[S]=T,p.nativeSymbol[S]=null,p.innerWindowID[S]=0,p.implementation[S]=null,p.line[S]=void 0===i?null:i,p.column[S]=void 0===c?null:c,p.length=Math.max(p.length,S+1),g.frame.push(S),g.prefix.push(x),m.set(n,g.length++)}}for(let e=0;e<u.length;e++){const t=u[e];if(n.lastSeenTime+=h[e]/1e3,n.lastSeenTime-n.lastSampledTime>=r.meta.interval){n.lastSampledTime=n.lastSeenTime;const e=(0,i.Nn)(m.get(t),"Could not find the stack information for a sample when decoding a Chrome profile.");(0,i.Nn)(b.eventDelay,"Could not find the eventDelay in samplesTable inside the newly created Chrome profile thread.").push(null),b.stack.push(e),(0,i.Nn)(b.time).push(n.lastSampledTime),b.length++}}}}for(const e of r.threads)U(e.stackTable);if(await async function(e,t,r,n,a){if(!a)return;if(!a||0===a.length)return;const{thread:s}=O(e,t,r,n,a[0]),c=o.M.withBackingArray(s.stringArray),u=(0,i.Nn)(n.meta.categories).findIndex((e=>"Graphics"===e.name));if(-1===u)throw new Error("Could not find the Graphics category in the profile's category list.");for(const e of a){const t="data:image/jpg;base64,"+e.args.snapshot,r=await F(t);null!==r&&(s.markers.data.push({type:"CompositorScreenshot",url:c.indexForString(t),windowID:"id",windowWidth:r.width,windowHeight:r.height}),s.markers.name.push(c.indexForString("CompositorScreenshot")),s.markers.startTime.push(e.ts/1e3),s.markers.endTime.push(null),s.markers.phase.push(l.mN),s.markers.category.push(u),s.markers.length++)}}(c,u,e,r,e.get("Screenshot")),function(e,t,r,n){const a=(0,i.Nn)(n.meta.categories).findIndex((e=>"Other"===e.name));if(-1===a)throw new Error('No "Other" category in empty profile category list');n.meta.markerSchema=[{name:"EventDispatch",chartLabel:"{marker.data.type2}",tooltipLabel:"{marker.data.type2} - EventDispatch",tableLabel:"{marker.data.type2}",display:["marker-chart","marker-table","timeline-overview"],data:[{key:"type2",label:"Event Type",format:"string",searchable:!0}]}];for(const[s,i]of r.entries())if("Profile"!==s&&"ProfileChunk"!==s&&"CpuProfile"!==s)for(const c of i)if(void 0!==c.ts&&Number.isFinite(c.ts)&&("X"===c.ph&&void 0!==c.dur&&Number.isFinite(c.dur)||"B"===c.ph||"E"===c.ph||"b"===c.ph||"n"===c.ph||"e"===c.ph||"i"===c.ph||"I"===c.ph||"R"===c.ph)){const i=c.ts/1e3,u=O(e,t,r,n,c),{thread:m}=u,{markers:d,stringArray:h}=m,f=o.M.withBackingArray(h);let p=null;c.args&&"object"==typeof c.args&&(p=c.args.data||null),d.name.push(f.indexForString(s)),d.category.push(a),p&&"type"in p&&(p.type2=p.type),p&&"category"in p&&(p.category2=p.category);const g={...p,type:s,category:c.cat};if(d.data.push(g),"X"===c.ph){const e=c.dur/1e3;d.phase.push(l.KU),d.startTime.push(i),d.endTime.push(i+e)}else"B"===c.ph||"b"===c.ph?(d.startTime.push(i),d.endTime.push(null),d.phase.push(l.nO)):"E"===c.ph||"e"===c.ph?(d.startTime.push(null),d.endTime.push(i),d.phase.push(l.a1)):(d.startTime.push(i),d.endTime.push(null),d.phase.push(l.mN));d.length++}}(c,u,e,r),void 0===r.meta.profilingStartTime&&void 0===r.meta.profilingEndTime&&e.has("TracingStartedInBrowser")){const t=(0,i.Nn)(e.get("TracingStartedInBrowser"))[0];if(void 0!==t.ts&&Number.isFinite(t.ts)){let e=-1/0;r.threads.forEach((t=>{const n=I(t,r.meta.interval);e=Math.max(e,n.end)})),r.meta.profilingStartTime=t.ts/1e3,r.meta.profilingEndTime=e}}if(t){const e=/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/g;let n,a;for(;null!==(a=e.exec(t));)n=a;if(n){const[,e,t,a,s,o,i]=n,l=new Date(`${e}-${t}-${a}T${s}:${o}:${i}`);r.meta.startTime=l.getTime()-(r.meta.profilingStartTime??0)}}return r.threads.sort(((e,t)=>{const r=u.get(e),n=u.get(t);if(!r||!n)throw console.error({threadA:e,threadB:t}),new Error("Unexpected thread");if(r.pid===n.pid){if(r.threadSortIndex!==n.threadSortIndex)return r.threadSortIndex-n.threadSortIndex}else if(r.processSortIndex!==n.processSortIndex)return r.processSortIndex-n.processSortIndex;return r.tieBreakerIndex-n.tieBreakerIndex})),r}(n,t)}(a,t);if(u)return u;const m=function(e){if(!e||"object"!=typeof e)return null;const{dhatFileVersion:t}=e;if("number"!=typeof t)return null;if(2!==t)throw new Error(`This importer only supports dhat version 2. The file provided was version ${t}.`);const r=(0,i.au)(e),n=(0,s.Z)();n.meta.product=r.cmd+" (dhat)",n.meta.importedFrom="dhat";const a=(0,s.x2)(),{funcTable:l,stringArray:c,stackTable:u,frameTable:m}=(0,s.Qh)(),d=o.M.withBackingArray(c),h=new Map;l.name.push(d.indexForString(r.cmd)),l.isJS.push(!1),l.relevantForJS.push(!1),l.resource.push(-1),l.fileName.push(null),l.lineNumber.push(null),l.columnNumber.push(null);const f=l.length++;m.address.push(-1),m.line.push(null),m.column.push(null),m.category.push(0),m.subcategory.push(0),m.innerWindowID.push(null),m.implementation.push(null),m.nativeSymbol.push(null),m.inlineDepth.push(0),m.func.push(f);const p=m.length++;u.frame.push(p),u.prefix.push(null);const g=u.length++;for(let e of r.ftbl){let t=r.cmd,n=-1,a=null,s=null;const o=e.match(/^0x([0-9a-f]+): (.+) \((?:in )?(.+?)(?::(\d+))?(?::(\d+))?\)$/i);o&&(n=parseInt(o[1],16),e=o[2],t=o[3],a=o[4]?Number(o[4]):null,s=o[5]?Number(o[5]):null);const i=`${e} ${t}`;let c=h.get(i);void 0===c&&(l.name.push(d.indexForString(e)),l.isJS.push(!1),l.relevantForJS.push(!1),l.resource.push(-1),l.fileName.push(d.indexForString(t)),l.lineNumber.push(a),l.columnNumber.push(s),c=l.length++,h.set(i,c)),m.address.push(n),m.line.push(a),m.column.push(s),m.category.push(0),m.subcategory.push(0),m.innerWindowID.push(null),m.implementation.push(null),m.nativeSymbol.push(null),m.inlineDepth.push(0),m.func.push(c),m.length++}const y=[],b=[],w=[],k=[],v=new Map;for(const e of r.pps){let t=0,r=g;for(let n=e.fs.length-1;n>=0;n--){const a=e.fs[n]+1,s=(0,i.Nn)(m.func[a],"Expected to find a funcIndex from a frameIndex");t=u.length;const o=v.get(r);if(o)for(const e of o){const r=u.frame[e];if(m.func[r]===s){t=e;break}}t===u.length&&(u.frame.push(a),u.prefix.push(r),o?o.push(t):v.set(r,[t]),u.length++),r=t}y.push(e.tb),b.push(e.mb),w.push(e.gb),k.push(e.eb),a.time.push(0),a.stack.push(t),a.length++}return n.threads=[{name:"Total Bytes",weight:y},{name:"Maximum Bytes",weight:b},{name:"Bytes at Global Max",weight:w},{name:"Bytes at End",weight:k}].map((({name:e,weight:t},n)=>{const o=(0,s.Qh)();return o.pid=r.pid,o.tid=n,o.name=e,o.stringArray=d.getBackingArray(),o.funcTable.name=l.name.slice(),o.funcTable.isJS=l.isJS.slice(),o.funcTable.relevantForJS=l.relevantForJS.slice(),o.funcTable.resource=l.resource.slice(),o.funcTable.fileName=l.fileName.slice(),o.funcTable.lineNumber=l.lineNumber.slice(),o.funcTable.columnNumber=l.columnNumber.slice(),o.funcTable.length=l.length,o.frameTable.address=m.address.slice(),o.frameTable.line=m.line.slice(),o.frameTable.column=m.column.slice(),o.frameTable.category=m.category.slice(),o.frameTable.subcategory=m.subcategory.slice(),o.frameTable.innerWindowID=m.innerWindowID.slice(),o.frameTable.implementation=m.implementation.slice(),o.frameTable.func=m.func.slice(),o.frameTable.length=m.length,o.stackTable.frame=u.frame.slice(),o.stackTable.prefix=u.prefix.slice(),o.stackTable.length=u.length,o.nativeAllocations={time:a.time.slice(),stack:a.stack.slice(),weight:t,weightType:"bytes",length:a.length},o})),n}(a);return m||function(e){if(!e)throw new Error("The profile was empty.");if("object"!=typeof e)throw new Error("The profile was not an object");const t=(0,i.au)(e.profile?e.profile:e);if(!t.meta)throw new Error("This does not appear to be a valid Gecko Profile, there is no meta field.");return function(e){!function(e){const t=W(e).version||0;if(t!==l.xC){if(t>l.xC)throw new Error(`Unable to parse a Gecko profile of version ${t}, most likely profiler.firefox.com needs to be refreshed. The most recent version understood by this version of profiler.firefox.com is version ${l.xC}.\nYou can try refreshing this page in case profiler.firefox.com has updated in the meantime.`);for(let r=t+1;r<=l.xC;r++)r in z&&z[r](e);W(e).version=l.xC}}(e);const t=[],r=e.meta.extensions?me(e.meta.extensions):(0,s.Ie)(),n=new de;for(const a of e.threads)t.push(xe(a,e,r,n));const a=Te(e,t,0),i=[Se(e,t,0)];for(const s of e.processes){const o=s.meta.startTime-e.meta.startTime;for(const e of s.threads){const a=xe(e,s,r,n);a.samples=Ie(a.samples,o),a.markers=Ne(a.markers,o),a.jsTracer&&(a.jsTracer=Me(a.jsTracer,o)),a.jsAllocations&&(a.jsAllocations=_e(a.jsAllocations,o)),a.nativeAllocations&&(a.nativeAllocations=_e(a.nativeAllocations,o)),a.processStartupTime+=o,null!==a.processShutdownTime&&(a.processShutdownTime+=o),a.registerTime+=o,null!==a.unregisterTime&&(a.unregisterTime+=o),t.push(a)}a.push(...Te(s,t,o)),i.push(Se(s,t,o))}let c=[...e.pages||[]];for(const t of e.processes)c=c.concat(t.pages||[]);const u={interval:e.meta.interval,startTime:e.meta.startTime,abi:e.meta.abi,extensions:r,misc:e.meta.misc,oscpu:e.meta.oscpu,platform:e.meta.platform,processType:e.meta.processType,product:e.meta.product||"",stackwalk:e.meta.stackwalk,debug:!!e.meta.debug,toolkit:e.meta.toolkit,version:e.meta.version,categories:e.meta.categories,preprocessedProfileVersion:l.Ie,appBuildID:e.meta.appBuildID,visualMetrics:e.meta.visualMetrics,configuration:e.meta.configuration,sourceURL:e.meta.sourceURL,physicalCPUs:e.meta.physicalCPUs,logicalCPUs:e.meta.logicalCPUs,CPUName:e.meta.CPUName,symbolicated:!!e.meta.presymbolicated,updateChannel:e.meta.updateChannel,markerSchema:Ee(e),sampleUnits:e.meta.sampleUnits,device:e.meta.device};void 0!==e.meta.profilingStartTime&&(u.profilingStartTime=e.meta.profilingStartTime,u.profilingEndTime=e.meta.profilingEndTime);const m=i.reduce(((e,t)=>(null!==t&&e.push(t),e)),[]);let d={...e.profilingLog||{}};for(const t of e.processes)d={...d,...t.profilingLog||{}};const h={...e.profileGatheringLog||{}};for(const r of t.slice()){const{jsTracer:n}=r;if(n){const a=N(t,r),s=le(r,n,e.meta.categories);s.isJsTracer=!0,s.name=`JS Tracer of ${a}`,t.push(s),delete r.jsTracer}}u.visualMetrics&&function(e,t,r){const{visualMetrics:n}=t;if(0===r.length||!n)return;const a=e.findIndex((e=>"GeckoMain"===e.name&&"default"===e.processType)),s=function(e,t){for(let r=0;r<e.length;r++){const n=e[r];if("GeckoMain"!==n.name||"tab"!==n.processType)continue;const a=new Set(t.filter((e=>0===e.embedderInnerWindowID)).map((e=>e.innerWindowID))),s=o.M.withBackingArray(n.stringArray);if(!s.hasString("RefreshDriverTick"))continue;const i=s.indexForString("RefreshDriverTick"),{markers:l}=n;for(let e=0;e<l.length;e++)if(l.name[e]===i&&l.data[e]&&l.data[e].innerWindowID&&a.has(l.data[e].innerWindowID))return r}return null}(e,r);if(-1===a||!s)return;const i=e[a],c=e[s],u=o.M.withBackingArray(c.stringArray),m=["Visual","ContentfulSpeedIndex","PerceptualSpeedIndex"];if(void 0===t.categories)return;const d=t.categories.findIndex((e=>"Test"===e.name));function h(e,t,r,n,a,s){if(r!==l.a1&&null===n||(r===l.KU||r===l.a1)&&null===a)return;const i=o.M.withBackingArray(e.stringArray);e.markers.name.push(i.indexForString(t)),e.markers.startTime.push(n),e.markers.endTime.push(a),e.markers.phase.push(r),e.markers.category.push(d),e.markers.data.push(s??null),e.markers.length++}let f=null;if(u.hasString("Navigation::Start")){const e=u.indexForString("Navigation::Start"),t=c.markers.name.findIndex((t=>t===e));-1===t?console.error("Failed to find the navigation start marker."):f=c.markers.startTime[t]}for(const e of m){const r=n[`${e}Progress`];if(!r)continue;const a=f??r[0].timestamp,s=r[r.length-1].timestamp,o=`${e} Progress`;h(i,o,l.KU,a,s),h(c,o,l.KU,a,s);const u={name:"VisualMetricProgress",tableLabel:"{marker.name} — {marker.data.percentage}",display:["marker-chart","marker-table"],data:[{key:"percentage",label:"Percentage",format:"percentage"}]};t.markerSchema.push(u);const m=`${e} Change`;for(const{timestamp:e,percent:t}of r){const r={type:"VisualMetricProgress",percentage:t/100};h(i,m,l.mN,e,null,r),h(c,m,l.mN,e,null,r)}}}(t,u,c);const{libs:f}=n.finish();return{meta:u,libs:f,pages:c,counters:a,profilerOverhead:m,threads:t,profilingLog:d,profileGatheringLog:h}}(t)}(a)}catch(e){throw console.error("UnserializationError:",e),new Error(`Unserializing the profile failed: ${e}`)}var n}class De extends Error{constructor(e,t,...r){super([e,...r.map((e=>` - ${e.name}: ${e.message}`))].join("\n")),this.library=void 0,this.errors=void 0,this.__proto__=De.prototype,this.name="SymbolsNotFoundError",this.library=t,this.errors=r}}class Oe{constructor(e,t=200,r=12096e5){this._dbPromise=void 0,this._maxCount=void 0,this._maxAge=void 0,this._dbPromise=this._setupDB(e),this._maxCount=t,this._maxAge=r}_getDB(){return this._dbPromise?this._dbPromise:Promise.reject(new Error("The database is closed."))}_setupDB(e){const t=window.indexedDB;if(!t)throw new Error("Could not find indexedDB on the window object.");return new Promise(((r,n)=>{const a=t.open(e,2);a.onerror=()=>{if("VersionError"===a.error.name){const a=t.deleteDatabase(e);a.onerror=()=>n(a.error),a.onsuccess=()=>{this._setupDB(e).then(r,n)}}else n(a.error)},a.onupgradeneeded=({oldVersion:e})=>{const t=a.result;t.onerror=n,1===e&&t.deleteObjectStore("symbol-tables"),t.createObjectStore("symbol-tables",{keyPath:["debugName","breakpadId"]}).createIndex("lastUsedDate","lastUsedDate")},a.onblocked=()=>{n(new Error("The symbol store database could not be upgraded because it is open in another tab. Please close all your other profiler.firefox.com tabs and refresh."))},a.onsuccess=()=>{const e=a.result;e.onversionchange=()=>{e.close()},r(e),this._deleteAllBeforeDate(e,new Date(+new Date-this._maxAge)).catch((e=>{console.error("Encountered error while cleaning out database:",e)}))}}))}storeSymbolTable(e,t,[r,n,a]){return this._getDB().then((s=>new Promise(((o,i)=>{const l=s.transaction("symbol-tables","readwrite");l.onerror=()=>i(l.error);const c=l.objectStore("symbol-tables");this._deleteLeastRecentlyUsedUntilCountIsNoMoreThanN(c,this._maxCount-1,(()=>{const s=new Date;c.add({debugName:e,breakpadId:t,addrs:r,index:n,buffer:a,lastUsedDate:s}).onsuccess=()=>o()}))}))))}getSymbolTable(e,t){return this._getDB().then((r=>new Promise(((n,a)=>{const s=r.transaction("symbol-tables","readwrite");s.onerror=()=>a(s.error);const o=s.objectStore("symbol-tables").openCursor([e,t]);o.onsuccess=()=>{const r=o.result;if(r){const e=r.value;e.lastUsedDate=new Date;const t=r.update(e),{addrs:a,index:s,buffer:o}=e;t.onsuccess=()=>n([a,s,o])}else a(new De("The requested library does not exist in the database.",{debugName:e,breakpadId:t}))}}))))}close(){return this._getDB().then((e=>{e.close(),this._dbPromise=null}))}_deleteAllBeforeDate(e,t){return new Promise(((r,n)=>{const a=e.transaction("symbol-tables","readwrite");a.onerror=()=>n(a.error);const s=a.objectStore("symbol-tables");this._deleteRecordsLastUsedBeforeDate(s,t,r)}))}_deleteRecordsLastUsedBeforeDate(e,t,r){const n=e.index("lastUsedDate"),a=window.IDBKeyRange.upperBound(t,!0),s=n.openCursor(a);s.onsuccess=()=>{const e=s.result;e?e.delete().onsuccess=()=>{e.continue()}:r()}}_deleteNLeastRecentlyUsedRecords(e,t,r){const n=e.index("lastUsedDate").openCursor();let a=0;n.onsuccess=()=>{const e=n.result;e?e.delete().onsuccess=()=>{a++,a<t?e.continue():r()}:r()}}_count(e,t){const r=e.count();r.onsuccess=()=>t(r.result)}_deleteLeastRecentlyUsedUntilCountIsNoMoreThanN(e,t,r){this._count(e,(n=>{if(n>t){const a=n-t;this._deleteNLeastRecentlyUsedRecords(e,a,r)}else r()}))}}function Pe(e,t,r,n){if(r=r||0,n=n||e.length,r<0||r>e.length||n<0||n>e.length)throw new TypeError("low and high must lie within the array's range");for(;r<n;){const a=r+n>>1;t<e[a]?n=a:r=a+1}return r}function Fe(e,t,r){const[n,a,s]=t,o=Uint32Array.from(e);o.sort();const i=new TextDecoder,l=new Map;let c,u,m="";for(let e=0;e<o.length;e++){const t=o[e],d=Pe(n,t,c)-1;if(d>=0){if(d!==c){const e=a[d],t=a[d+1],o=s.subarray(e,t);m=r(i.decode(o)),u=d<n.length-1?n[d+1]-n[d]:void 0,c=d}l.set(t,{symbolAddress:n[d],name:m,functionSize:u})}else l.set(t,{symbolAddress:0,name:"<before first symbol>"})}return l}class Ue{constructor(e,t){this._symbolProvider=void 0,this._db=void 0,this._symbolProvider=t,this._db="string"==typeof e?new Oe(`${e}-symbol-tables`):e}async closeDb(){await this._db.close()}_storeSymbolTableInDB(e,t){return this._db.storeSymbolTable(e.debugName,e.breakpadId,t).catch((t=>{console.log(`Failed to store the symbol table for ${e.debugName} in the database:`,t)}))}async getSymbols(e,t,n){e=e.filter((e=>{const{debugName:t,breakpadId:r}=e.lib;return""!==t&&""!==r||(n(e,new De(`Failed to symbolicate library ${t}/${r}`,e.lib,new Error("Invalid debugName or breakpadId"))),!1)}));const a=[],s=[];await Promise.all(e.map((async e=>{const{lib:t,addresses:r}=e,{debugName:n,breakpadId:o}=t;try{const e=await this._db.getSymbolTable(n,o);s.push({lib:t,addresses:r,symbolTable:e})}catch(t){if(!(t instanceof De))throw t;a.push(e)}})));const o=function(e,t,r,n){const a=[];for(const t of e){const e=n(t);let r=a.find((({value:t,elements:r})=>t+e<=1e4&&r.length+1<=10));void 0===r&&(r={value:0,elements:[]},a.push(r)),r.elements.push(t),r.value+=e}return a.map((({elements:e})=>e))}(a,0,0,(({addresses:e})=>e.size)).map((e=>[e,this._symbolProvider.requestSymbolsFromServer(e)])),i=await async function(){try{const{demangle_any:e}=await r.e(556).then(r.bind(r,556));return e}catch(e){return console.error("Demangling module could not be imported.",e),e=>e}}();for(const{lib:e,addresses:r,symbolTable:n}of s)t(e,Fe(r,n,i));await Promise.all(o.map((async([r,a])=>{const s=new Map(e.map((e=>[e,[]]))),o=await this._processSuccessfulResponsesAndReturnRemaining(r,a,s,t);if(0===o.length)return;const l=this._symbolProvider.requestSymbolsFromBrowser(o),c=await this._processSuccessfulResponsesAndReturnRemaining(o,l,s,t);0!==c.length&&await this._getSymbolTablesFromBrowser(c,s,i,t,n)})))}async _processSuccessfulResponsesAndReturnRemaining(e,t,r,n){try{const e=await t,a=[];for(let t=0;t<e.length;t++){const s=e[t];if("SUCCESS"===s.type){const{lib:e,results:t}=s;n(e,t)}else{const{request:e,error:t}=s;a.push(e),(0,i.Nn)(r.get(e)).push(t)}}return a}catch(t){for(const n of e)(0,i.Nn)(r.get(n)).push(t);return e}}async _getSymbolTablesFromBrowser(e,t,r,n,a){for(const s of e){const{lib:e,addresses:o}=s;try{const t=await this._symbolProvider.requestSymbolTableFromBrowser(e);n(e,Fe(o,t,r)),await this._storeSymbolTableInDB(e,t)}catch(r){a(s,new De(`Could not obtain symbols for ${e.debugName}/${e.breakpadId}.`,e,...t.get(s)??[],r))}}}}function $e(e,t,r,n,a){const{frameTable:i,funcTable:l,nativeSymbols:c,stringArray:u}=e,m=o.M.withBackingArray(u),{threadLibSymbolicationInfo:d,resultsForLib:h}=t,{resourceIndex:f,allFramesForThisLib:p,allFuncsForThisLib:g,allNativeSymbolsForThisLib:y,libIndex:b}=d,w=new Set(g),k=new Set(y),v=new Map,T=new Map,S=new Map,x=[],_=[];for(const e of p)i.inlineDepth[e]>0?(x.push(e),n[e]=1):_.push(e);for(const e of _){const t=i.nativeSymbol[e],r=i.address[e];let n=h.get(r);if(void 0===n)if(null!==t){const e=m.getString(c.name[t]);n={symbolAddress:c.address[t],name:e}}else n={symbolAddress:r,name:`0x${r.toString(16)}`};const a=n.symbolAddress;if(v.set(e,a),T.set(a,n),null!==t&&!S.has(a)&&k.has(t)){const e=t;k.delete(e),S.set(a,e)}}const I=k.values(),M=(0,s.dY)(c);for(const[e,t]of T){const r=m.indexForString(t.name);let n=S.get(e);void 0===n&&(n=I.next().value,void 0===n&&(n=M.length,M.libIndex[n]=b,M.length++),S.set(e,n)),M.address[n]=e,M.name[n]=r,M.functionSize[n]=t.functionSize??null}const C=i.nativeSymbol.slice();for(const[e,t]of v){const r=S.get(t);if(void 0===r)throw new Error("Impossible, all symbolAddresses have a canonical symbol at this point.");C[e]=r}const N=(0,s.LK)({...i,nativeSymbol:C}),E=(0,s.ES)(l),A=w.values(),D=new Map,O=x.values(),P=[];for(const e of _){const t=i.func[e],r=C[e];if(null===r)throw new Error("Impossible, all frames now have native symbols.");const n=i.address[e];let s=h.get(n);if(void 0===s){const n=M.name[r],a=E.fileName[t];s={symbolAddress:M.address[r],name:m.getString(n),file:null!==a?m.getString(a):void 0,line:i.line[e]??void 0}}const o=s.inlines?s.inlines.slice():[];o.push({name:s.name,file:s.file,line:s.line}),o.reverse();const l=[],c=[];for(let t=0;t<o.length;t++){const a=o[t],s=m.indexForString(a.name),i=void 0!==a.file?m.indexForString(a.file):null,u=`${s}:${i??""}`;let d,h=D.get(u);if(void 0===h&&(h=A.next().value,void 0===h&&(h=E.length,E.isJS[h]=!1,E.relevantForJS[h]=!1,E.resource[h]=f,E.fileName[h]=null,E.lineNumber[h]=null,E.columnNumber[h]=null,E.length++),E.name[h]=s,E.fileName[h]=i,D.set(u,h)),c.push(h),0===t)d=e;else{d=O.next().value,void 0===d&&(d=N.length,N.length++);const t=N.category[e],a=N.subcategory[e],s=N.innerWindowID[e],o=N.implementation[e];N.category[d]=t,N.subcategory[d]=a,N.innerWindowID[d]=s,N.implementation[d]=o,N.address[d]=n,N.nativeSymbol[d]=r}N.inlineDepth[d]=t,N.func[d]=h,N.line[d]=a.line??null,N.column[d]=null,l.push(d)}l.length>1&&a.set(e,l),P.push([t,c.join("#")])}const F=function(e){const t=new Map,r=new Set;for(const[n,a]of e){if(r.has(n))continue;const e=t.get(n);void 0!==e?e!==a&&(t.delete(n),r.add(n)):t.set(n,a)}return t}(P);for(const[e,t]of F)r.set(e,t.split("#").map((e=>+e)));return{...e,frameTable:N,funcTable:E,nativeSymbols:M}}e=r.hmd(e);const je=r(896);class Le{constructor(){this._store=void 0,this._store=new Map}_makeKey(e,t){return`${e}:${t}`}async storeSymbolTable(e,t,r){this._store.set(this._makeKey(e,t),r)}async getSymbolTable(e,t){const r=this._makeKey(e,t),n=this._store.get(r);if(void 0!==n)return n;throw new De("The requested library does not exist in the database.",{debugName:e,breakpadId:t})}async close(){}}if(!e.parent)try{(async function(e){console.log(`Loading profile from ${e.input}`);const t=JSON.parse(je.readFileSync(e.input,"utf8")),r=await Ae(t);if(void 0===r)throw new Error("Unable to parse the profile.");const n=new Le,a=new Ue(n,{requestSymbolsFromServer:async t=>{for(const{lib:e}of t)console.log(`  Loading symbols for ${e.debugName}`);try{return await async function(e,t,r){const n=t.map((e=>({request:e,addressArray:Array.from(e.addresses)}))),a={jobs:n.map((({request:e,addressArray:t})=>{const{debugName:r,breakpadId:n}=e.lib;return{memoryMap:[[r,n]],stacks:[t.map((e=>[0,e]))]}}))},s=function(e){if(!(e instanceof Object&&"results"in e))throw new Error("Expected an object with property `results`");const t=e.results;if(!Array.isArray(t))throw new Error("Expected `results` to be an array");for(const e of t){if(!(e instanceof Object&&"found_modules"in e&&"stacks"in e))throw new Error("Expected jobResult to have `found_modules` and `stacks` properties");if(!(e.found_modules instanceof Object))throw new Error("Expected `found_modules` to be an object");const t=e.stacks;if(!Array.isArray(t))throw new Error("Expected `stacks` to be an array");for(const e of t){if(!Array.isArray(e))throw new Error("Expected `stack` to be an array");for(const t of e){if(!(t instanceof Object))throw new Error("Expected `frameInfo` to be an object");if(!("module_offset"in t)||!("module"in t)||!("frame"in t))throw new Error("Expected frameInfo to have `module_offset`, `module` and `frame` properties");if("file"in t&&"string"!=typeof t.file)throw new Error("Expected frameInfo.file to be a string, if present");if("line"in t&&"number"!=typeof t.line)throw new Error("Expected frameInfo.line to be a number, if present");if("function_offset"in t&&"string"!=typeof t.function_offset)throw new Error("Expected frameInfo.function_offset to be a string, if present");if("function_size"in t&&"string"!=typeof t.function_size)throw new Error("Expected frameInfo.function_size to be a string, if present");if("inlines"in t){const e=t.inlines;if(!Array.isArray(e))throw new Error("Expected `inlines` to be an array");for(const t of e)if(!(t instanceof Object))throw new Error("Expected `inlineFrame` to be an object")}}}}return e}(await r("/symbolicate/v5",JSON.stringify(a)));return n.map((({request:t,addressArray:r},n)=>{const a=s.results[n];try{const{lib:n}=t,s=function(e,t,r,n){const{lib:a}=t,{debugName:s,breakpadId:o}=a;if(!n.found_modules[`${s}/${o}`])throw new Error(`The ${e} does not have symbols for ${s}/${o}.`);const i=n.stacks[0];if(i.length!==r.length)throw new Error(`The result from the ${e} has an unexpected length.`);const l=new Map;for(let e=0;e<i.length;e++){const t=r[e],n=i[e];let a;if(void 0!==n.function&&void 0!==n.function_offset){const e=n.function,r=parseInt(n.function_offset.substr(2),16);let s,o;if(void 0!==n.inlines){const e=n.inlines.length;s=n.inlines.map((({function:t,file:r,line:a},s)=>{const o=e-s;return{name:t??`<unknown at ${n.module_offset} at inline depth ${o}>`,file:r,line:a}}))}void 0!==n.function_size&&(o=parseInt(n.function_size.substr(2),16)),a={name:e,symbolAddress:t-r,file:n.file,line:n.line,inlines:s,functionSize:o}}else a={name:`<unknown at ${n.module_offset}>`,symbolAddress:t};l.set(t,a)}return l}(e,t,r,a);return{type:"SUCCESS",lib:n,results:s}}catch(e){return{type:"ERROR",request:t,error:e}}}))}("symbol server",t,(async(t,r)=>(await fetch(e.server+t,{body:r,method:"POST"})).json()))}catch(e){throw new Error(`There was a problem with the symbolication API request to the symbol server: ${e.message}`)}},requestSymbolsFromBrowser:async()=>[],requestSymbolTableFromBrowser:async()=>{throw new Error("Not supported in this context")}});console.log("Symbolicating...");const o=new Map;await async function(e,t,r){const n=e.threads.map((t=>function(e,t){const{frameTable:r,funcTable:n,nativeSymbols:a,resourceTable:o}=e,i=new Map;for(let e=0;e<o.length;e++){if(o.type[e]!==s.AU.library)continue;const l=o.lib[e];if(null===l)continue;const c=t[l];if(void 0===c)throw new Error("Did not find a lib.");const u=new Set;for(let t=0;t<n.length;t++)n.resource[t]===e&&u.add(t);const m=new Set;for(let e=0;e<a.length;e++)a.libIndex[e]===l&&m.add(e);const d=[],h=[];for(let t=0;t<r.length;t++){const a=r.func[t];n.resource[a]===e&&(d.push(t),h.push(r.address[t]))}const f=`${c.debugName}/${c.breakpadId}`;i.set(f,{libIndex:l,resourceIndex:e,allFuncsForThisLib:u,allNativeSymbolsForThisLib:m,allFramesForThisLib:d,frameAddresses:h})}return i}(t,e.libs))),a=function(e){const t=new Map;for(const r of e)for(const[e,{frameAddresses:n}]of r){let r=t.get(e);void 0===r&&(r=new Set,t.set(e,r));for(const e of n)r.add(e)}return Array.from(t).map((([e,t])=>{const[r,n]=e.split("/");return{lib:{debugName:r,breakpadId:n},addresses:t}}))}(n);await t.getSymbols(a,((t,a)=>{const{debugName:s,breakpadId:o}=t;!function(e,t,r,n,a){const{threads:s}=e;for(let e=0;e<s.length;e++){const s=t[e].get(n);void 0!==s&&a(e,{threadLibSymbolicationInfo:s,resultsForLib:r})}}(e,n,a,`${s}/${o}`,r)}),((e,t)=>{if(!(t instanceof De))throw t;console.warn(t)}))}(r,a,((e,t)=>{let r=o.get(e);void 0===r&&(r=[],o.set(e,r)),r.push(t)})),console.log("Applying collected symbolication steps..."),r.threads=r.threads.map(((e,t)=>{const r=o.get(t);if(void 0===r)return e;const{thread:n}=function(e,t){const r=new Map,n=e.frameTable.length,a=new Uint8Array(n),o=new Map;let i=e;for(const e of t)i=$e(i,e,r,a,o);return i=function(e,t,r){if(0===r.size)return e;const{stackTable:n}=e,a=(0,s.Gh)(),o=new Int32Array(n.length);for(let e=0;e<n.length;e++){const s=n.frame[e],i=n.prefix[e],l=null===i?-1:o[i];if(0!==t[s]){o[e]=l;continue}let c=r.get(s);void 0===c&&(c=[s]);let u=-1!==l?l:null;for(let e=0;e<c.length;e++){const t=c[e],r=a.length;a.frame.push(t),a.prefix.push(u),a.length++,u=r}o[e]=u??-1}return function(e,t,r){return M(e,t,r,r)}(e,a,(e=>{if(null===e)return null;const t=o[e];return-1!==t?t:null}))}(i,a,o),{thread:i,oldFuncToNewFuncsMap:r}}(e,r);return n})),r.meta.symbolicated=!0,console.log(`Saving profile to ${e.output}`),je.writeFileSync(e.output,JSON.stringify(r)),console.log("Finished.")})(function(e){const t=r(31)(e.slice(2));if(!("input"in t)||"string"!=typeof t.input)throw new Error("Argument --input must be supplied with the path to the input profile");if(!("output"in t)||"string"!=typeof t.output)throw new Error("Argument --output must be supplied with the path to the output profile");if(!("server"in t)||"string"!=typeof t.server)throw new Error("Argument --server must be supplied with the URI of the symbol server endpoint");return{input:t.input,output:t.output,server:t.server}}(process.argv)).catch((e=>{throw e}))}catch(e){console.error(e),process.exit(1)}},617:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(){this.clear()}n.prototype={toString:function(){return"[object MixedTupleMap]"},_hash:function(e){if(e===this._lastTuple)return this._lastHash;for(var t=e.length,n=[],a=[],s=[],o=0;o<t;o++){var i=e[o],l=void 0===i?"undefined":r(i);null===l||"object"!==l&&"function"!==l?(n.push("string"===l?'"'+i+'"':""+i),a.push(o)):s.push(o)}if(0===s.length)throw new Error("Tuple must have at least one non-primitive part");return n.push("["+s.concat(a).join()+"]"),this._lastTuple=e,this._lastHash={nonPrimOrder:s,primHash:n.join("/<[MI_SEP]>/")},this._lastHash},has:function(e){for(var t=this._cache,r=this._hash(e),n=r.nonPrimOrder.length,a=0;a<n;a++){var s=e[r.nonPrimOrder[a]];if(!t.has||!t.has(s))return!1;t=t.get(s)}return!!t.has&&t.has(r.primHash)},set:function(e,t){for(var r=this._cache,n=this._hash(e),a=n.nonPrimOrder.length,s=!1,o=0;o<a;o++){var i=e[n.nonPrimOrder[o]];!s&&r.has(i)?r=r.get(i):(s=!0,r.set(i,r=o<a-1?new WeakMap:new Map))}return r.set(n.primHash,t),this},get:function(e){for(var t=this._cache,r=this._hash(e),n=r.nonPrimOrder.length,a=0;a<n;a++){var s=e[r.nonPrimOrder[a]],o=t.get&&t.get(s);if(void 0===o)return o;t=o}return t.get&&t.get(r.primHash)},clear:function(){this._cache=new WeakMap,delete this._lastTuple,delete this._lastHash}},t.default=n,e.exports=t.default},720:(e,t,r)=>{r.d(t,{S:()=>n,x:()=>a});const n="SIMPLEPERF";function a(e,t){return new TextDecoder("utf8").decode(t.slice(0,e.length))===e}},737:(e,t,r)=>{r.d(t,{AU:()=>y,ES:()=>u,Gh:()=>s,Ie:()=>b,LK:()=>l,Qh:()=>w,Ry:()=>h,WU:()=>d,Z:()=>k,cy:()=>o,dY:()=>m,qc:()=>f,uv:()=>c,uz:()=>p,vA:()=>i,x2:()=>g,zl:()=>a});var n=r(839);function a(){return{weightType:"samples",weight:null,stack:[],time:[],length:0}}function s(){return{frame:[],prefix:[],length:0}}function o(){return{weightType:"samples",weight:null,eventDelay:[],stack:[],time:[],length:0}}function i(){return{address:[],inlineDepth:[],category:[],subcategory:[],func:[],nativeSymbol:[],innerWindowID:[],implementation:[],line:[],column:[],length:0}}function l(e){return{address:e.address.slice(),inlineDepth:e.inlineDepth.slice(),category:e.category.slice(),subcategory:e.subcategory.slice(),func:e.func.slice(),nativeSymbol:e.nativeSymbol.slice(),innerWindowID:e.innerWindowID.slice(),implementation:e.implementation.slice(),line:e.line.slice(),column:e.column.slice(),length:e.length}}function c(){return{isJS:[],relevantForJS:[],name:[],resource:[],fileName:[],lineNumber:[],columnNumber:[],length:0}}function u(e){return{isJS:e.isJS.slice(),relevantForJS:e.relevantForJS.slice(),name:e.name.slice(),resource:e.resource.slice(),fileName:e.fileName.slice(),lineNumber:e.lineNumber.slice(),columnNumber:e.columnNumber.slice(),length:e.length}}function m(e){return{libIndex:e.libIndex.slice(),address:e.address.slice(),name:e.name.slice(),functionSize:e.functionSize.slice(),length:e.length}}function d(){return{lib:[],name:[],host:[],type:[],length:0}}function h(){return{libIndex:[],address:[],name:[],functionSize:[],length:0}}function f(){return{data:[],name:[],startTime:[],endTime:[],phase:[],category:[],length:0}}function p(){return{time:[],className:[],typeName:[],coarseType:[],weight:[],weightType:"bytes",inNursery:[],stack:[],length:0}}function g(){return{time:[],weight:[],weightType:"bytes",stack:[],length:0}}const y={unknown:0,library:1,addon:2,webhost:3,otherhost:4,url:5};function b(){return{id:[],name:[],baseURL:[],length:0}}function w(e){return{processType:"default",processStartupTime:0,processShutdownTime:null,registerTime:0,unregisterTime:null,pausedRanges:[],name:"Empty",isMainThread:!1,pid:"0",tid:0,samples:{weightType:"samples",weight:null,eventDelay:[],stack:[],time:[],length:0},markers:{data:[],name:[],startTime:[],endTime:[],phase:[],category:[],length:0},stackTable:{frame:[],prefix:[],length:0},frameTable:{address:[],inlineDepth:[],category:[],subcategory:[],func:[],nativeSymbol:[],innerWindowID:[],implementation:[],line:[],column:[],length:0},stringArray:[],funcTable:{isJS:[],relevantForJS:[],name:[],resource:[],fileName:[],lineNumber:[],columnNumber:[],length:0},resourceTable:{lib:[],name:[],host:[],type:[],length:0},nativeSymbols:{libIndex:[],address:[],name:[],functionSize:[],length:0},...e}}function k(){return{meta:{interval:1,startTime:0,abi:"",misc:"",oscpu:"",platform:"",processType:0,extensions:{id:[],name:[],baseURL:[],length:0},categories:[{name:"Other",color:"grey",subcategories:["Other"]},{name:"Idle",color:"transparent",subcategories:["Other"]},{name:"Layout",color:"purple",subcategories:["Other"]},{name:"JavaScript",color:"yellow",subcategories:["Other"]},{name:"GC / CC",color:"orange",subcategories:["Other"]},{name:"Network",color:"lightblue",subcategories:["Other"]},{name:"Graphics",color:"green",subcategories:["Other"]},{name:"DOM",color:"blue",subcategories:["Other"]}],product:"Firefox",stackwalk:0,toolkit:"",version:n.xC,preprocessedProfileVersion:n.Ie,appBuildID:"",sourceURL:"",physicalCPUs:0,logicalCPUs:0,CPUName:"",symbolicated:!0,markerSchema:[]},libs:[],pages:[],threads:[]}}},839:(e,t,r)=>{r.d(t,{Ie:()=>a,KU:()=>o,a1:()=>l,mN:()=>s,nO:()=>i,xC:()=>n});const n=31,a=53,s=0,o=1,i=2,l=3},896:e=>{e.exports=require("fs")},919:(e,t,r)=>{function n(e,...t){return Object.assign({},e,...t)}function a(e){return e}function s(e,t){if(null===e)throw new Error(t||"Expected an item to exist, and it was null.");if(void 0===e)throw new Error(t||"Expected an item to exist, and it was undefined.");return e}r.d(t,{Cn:()=>n,Nn:()=>s,au:()=>a})}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={id:e,loaded:!1,exports:{}};return a[e].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=a,o.c=s,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,r)=>(o.f[r](e,t),t)),[])),o.u=e=>e+".symbolicator-cli.js",o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="",e={792:1},o.f.require=(t,r)=>{e[t]||(t=>{var r=t.modules,n=t.ids,a=t.runtime;for(var s in r)o.o(r,s)&&(o.m[s]=r[s]);a&&a(o);for(var i=0;i<n.length;i++)e[n[i]]=1})(require("./"+o.u(t)))},t={},r={383:function(){return{}}},n={556:[383]},o.w={},o.f.wasm=function(e,a){(n[e]||[]).forEach((function(n,s){var i=t[n];if(i)a.push(i);else{var l,c=r[n](),u=new Promise((function(t,r){var{readFile:a}=require("fs"),{join:s}=require("path");try{a(s(__dirname,{556:{383:"8f4c70a2b0be975d3b02"}}[e][n]+".module.wasm"),(function(e,n){if(e)return r(e);t({arrayBuffer:()=>n})}))}catch(e){r(e)}}));if(c&&"function"==typeof c.then){var m=u.then((function(e){return e.arrayBuffer()}));l=Promise.all([m.then((function(e){return WebAssembly.compile(e)})),c]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}))}else l=(m=u.then((function(e){return e.arrayBuffer()}))).then((function(e){return WebAssembly.instantiate(e,c)}));a.push(t[n]=l.then((function(e){return o.w[n]=(e.instance||e).exports})))}}))},o(294)})();